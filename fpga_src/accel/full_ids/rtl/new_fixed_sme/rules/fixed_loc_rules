alert tcp $EXTERNAL_NET any -> $HOME_NET 24800 ( msg:"APP-DETECT Synergy network kvm usage detected"; flow:established; content:"Synergy",depth 7,offset 4,nocase; flowbits:set,synergy; metadata:policy max-detect-ips drop; reference:url,synergy-foss.org; classtype:attempted-admin; sid:21332; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Nuclear Pack exploit kit binary download"; flow:to_server,established; http_raw_uri; bufferlen:47; http_uri; content:"/g/",depth 3; pcre:"/g\/\d{9}\/[0-9a-f]{32}\/[0-9]$/"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:cve,2006-0003; reference:cve,2007-5659; reference:cve,2008-0655; reference:cve,2008-2992; reference:cve,2009-0927; reference:cve,2010-1885; reference:cve,2011-0559; reference:cve,2011-2110; reference:cve,2011-3544; reference:cve,2012-0188; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-1889; reference:cve,2012-4681; reference:url,blog.eset.com/2012/04/05/blackhole-exploit-kit-plays-with-smart-redirection; reference:url,blog.fox-it.com/2012/03/16/post-mortem-report-on-the-sinowallnu-nl-incident/; reference:url,snort.org/rule_docs/1-23157; classtype:trojan-activity; sid:23157; rev:10; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Redkit exploit kit encrypted binary download"; flow:to_client,established; flowbits:isset,java_user_agent; file_data; content:"|FB 67 1F 49|",depth 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:cve,2012-0188; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2013-0422; reference:cve,2013-2423; classtype:trojan-activity; sid:26805; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Flim exploit kit portable executable download"; flow:to_client,established; file_data; content:"|4F CF 6A BC A1 03 01 00 69|",depth 9; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:26962; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Styx exploit kit landing page request"; flow:to_server,established; http_raw_uri; bufferlen:>100; http_uri; content:"/i.html?",depth 8; pcre:"/\/i\.html\?[a-z0-9]+\=[a-zA-Z0-9]{25}/"; flowbits:set,styx_landing; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:cve,2007-5659; reference:cve,2008-0655; reference:cve,2011-3544; reference:cve,2012-0507; reference:cve,2012-1723; reference:cve,2012-4681; reference:cve,2012-4969; reference:cve,2013-0422; reference:cve,2013-2423; classtype:trojan-activity; sid:29452; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Nuclear exploit kit outbound payload request"; flow:to_server,established; http_uri; content:"/f/",depth 3; pcre:"/^\/f(?:\/\d)?\/1[34]\d{8}(?:\/\d{9,10})?(?:\/\d)+[^a-zA-Z]{1,6}$/"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community; service:http; classtype:trojan-activity; sid:30220; rev:6; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Goon/Infinity/Rig exploit kit encrypted binary download"; flow:to_client,established; file_data; content:"|89 B4 F4 6A 24 1F 46 14|",depth 8; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:30934; rev:3; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Hanjuan exploit kit encrypted binary download"; flow:to_client,established; file_data; content:"|71 75 B9 86 D8 51 1B 7B|",depth 8; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,malware-traffic-analysis.net/2014/08/22/index2.html; classtype:trojan-activity; sid:31699; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Multiple exploit kit flash file download"; flow:to_client,established; flowbits:isset,file.exploit_kit.flash; file_data; content:"CWS",depth 3; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:31902; rev:2; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Multiple exploit kit flash file download"; flow:to_client,established; flowbits:isset,file.exploit_kit.flash; file_data; content:"ZWS",depth 3; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:31903; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Nuclear exploit kit outbound structure"; flow:to_server,established; http_uri; content:"/f/",depth 3; pcre:"/^\/f(\/[^\x2f]+)?\/14\d{8}(\/\d{9,10})?(\/\d)+(\/x[a-f0-9]+(\x3b\d)+?)?$/"; flowbits:set,file.exploit_kit.pe; metadata:ruleset community; service:http; classtype:trojan-activity; sid:32386; rev:4; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"EXPLOIT-KIT Angler exploit kit encrypted binary download"; flow:to_client,established; file_data; content:"|0B C7 6A 1E 7C C2 43 EA|",depth 8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:33185; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Rig exploit kit outbound communication"; flow:established,to_server; http_uri; bufferlen:>80; content:"/index.php?",depth 11; content:"=l3S",within 4,distance 15,fast_pattern; pcre:"/^\/index\.php\?[A-Za-z0-9_-]{15}=l3S/"; flowbits:set,file.exploit_kit.flash; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:33905; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"EXPLOIT-KIT Rig exploit kit outbound communication"; flow:established,to_server; http_uri; bufferlen:>160; content:"/?",depth 2; content:"=l3S",within 4,distance 15,fast_pattern; pcre:"/^\/\?[A-Za-z0-9_-]{15}=l3S/"; flowbits:set,file.exploit_kit.flash; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:33906; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"EXPLOIT-KIT Sundown Exploit Kit redirection attempt"; flow:established,to_server; http_uri; content:"/noone.php",depth 10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:41035; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-FLASH Adobe Flash Player malformed ATF heap overflow attempt"; flow:to_client,established; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; isdataat:15; byte_test:1,<,13,13; byte_test:1,<,4,14; byte_test:1,<,14,15; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-1002; reference:cve,2016-1102; reference:cve,2016-4135; reference:cve,2017-2927; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-08.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-15.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:39273; rev:8; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-FLASH Adobe Flash Player malformed ATF heap overflow attempt"; flow:to_server,established; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; isdataat:15; byte_test:1,<,13,13; byte_test:1,<,4,14; byte_test:1,<,14,15; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-1002; reference:cve,2016-1102; reference:cve,2016-4135; reference:cve,2017-2927; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-08.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-15.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:39274; rev:8; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-FLASH Adobe Flash Player malformed ATF file length load buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.atf; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; isdataat:!1200; byte_extract:4,1,file_length,relative; isdataat:!file_length,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-4138; reference:cve,2017-2933; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:39308; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-FLASH Adobe Flash Player malformed ATF file length load buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.atf; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; isdataat:!1200; byte_extract:4,1,file_length,relative; isdataat:!file_length,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-4138; reference:cve,2017-2933; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:39309; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-FLASH Adobe Flash Player malformed ATF file length heap overflow attempt"; flow:to_client,established; flowbits:isset,file.atf; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; byte_test:1,>=,0x80,1,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-2934; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:41156; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-FLASH Adobe Flash Player malformed ATF file length heap overflow attempt"; flow:to_server,established; flowbits:isset,file.atf; file_data; content:"ATF",depth 3; content:"|FF|",within 1,distance 3; byte_test:1,>=,0x80,1,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-2934; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-02.html; classtype:attempted-user; sid:41157; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MPEG video stream file magic detected"; flow:to_client,established; file_data; content:"|00 00 01 B3|",depth 4; flowbits:set,file.mpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20450; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MPEG sys stream file magic detected"; flow:to_client,established; file_data; content:"|00 00 01 BA|",depth 4; flowbits:set,file.mpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20451; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Script encoder file magic detected"; flow:to_client,established; file_data; content:"|23 40 7E 5E|",depth 4; flowbits:set,file.screnc; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20453; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Postscript file magic detected"; flow:to_client,established; file_data; content:"|25 21 50 53 2D 41 64 6F 62 65 2D|",depth 11; flowbits:set,file.postscript; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20454; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY RealNetworks Real Media file magic detected"; flow:to_client,established; file_data; content:".RMF",depth 4; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20456; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY bzip file magic detected"; flow:to_client,established; file_data; content:"BZh",depth 3; flowbits:set,file.bzip; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20458; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY GIF file magic detected"; flow:to_client,established; file_data; content:"GIF8",depth 4,fast_pattern; content:"a",within 1,distance 1; flowbits:set,file.gif; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20459; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MP3 file magic detected"; flow:to_client,established; file_data; content:"ID3",depth 3; flowbits:set,file.mp3; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20460; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Windows CAB file magic detected"; flow:to_client,established; file_data; content:"MSCF",depth 4; flowbits:set,file.cab; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20461; rev:17; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Ogg Stream file magic detected"; flow:to_client,established; file_data; content:"OggS|00|",depth 5; flowbits:set,file.ogg; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20462; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY RIFX file magic detected"; flow:to_client,established; file_data; content:"RIFX",depth 4; flowbits:set,file.dir; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20471; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY RAR file magic detected"; flow:to_client,established; file_data; content:"Rar|21 1A 07|",depth 6; flowbits:set,file.rar; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20472; rev:25; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Symantec file magic detected"; flow:to_client,established; file_data; content:"X-Symantec-",depth 11; flowbits:set,file.symantec; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20474; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ARJ file magic detected"; flow:to_client,established; file_data; content:"|60 EA 00 00|",depth 4; flowbits:set,file.arj; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20475; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY TNEF file magic detected"; flow:to_client,established; file_data; content:"x|9F|>|22|",depth 4; flowbits:set,file.tnef; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20476; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ELF file magic detected"; flow:to_client,established; file_data; content:"|7F|ELF",depth 4; flowbits:set,file.elf; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20477; rev:18; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY PNG file magic detected"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|",depth 8; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20478; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MP3 file magic detected"; flow:to_client,established; file_data; content:"|FF FB|",depth 2; flowbits:set,file.mp3; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20481; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_client,established; file_data; content:"|FF D8 FF E0|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20483; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_client,established; file_data; content:"|FF D8 FF E1|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24455; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_client,established; file_data; content:"|FF D8 FF EE|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24456; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY SIS file magic detected"; flow:to_client,established; file_data; content:"|19 04 00 10|",depth 4; flowbits:set,file.sis; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20484; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY SIP log file magic detected"; flow:to_client,established; file_data; content:"|53 49 50 2D 48 49 54 20 28 53 49 50 2F 48|",depth 14; flowbits:set,file.siplog; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20485; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY 7zip file magic detected"; flow:to_client,established; file_data; content:"7z|BC AF 27 1C|",depth 6; flowbits:set,file.7zip; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20487; rev:17; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MachO Little Endian file magic detected"; flow:to_client,established; file_data; content:"|CE FA ED FE|",depth 4; flowbits:set,file.machole; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20488; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MachO x64 Little Endian file magic detected"; flow:to_client,established; file_data; content:"|CF FA ED FE|",depth 4; flowbits:set,file.macho64le; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20489; rev:20; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MachO Big Endian file magic detected"; flow:to_client,established; file_data; content:"|FE ED FA CE|",depth 4; flowbits:set,file.machobe; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20490; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MachO x64 Big Endian file magic detected"; flow:to_client,established; file_data; content:"|FE ED FA CF|",depth 4; flowbits:set,file.macho64be; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20491; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Universal Binary/Java Bytecode file magic detected"; flow:to_client,established; file_data; content:"|CA FE BA BE|",depth 4; flowbits:set,file.universalbinary; flowbits:set,file.class; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20492; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY jarpack file magic detected"; flow:to_client,established; file_data; content:"|CA FE D0 0D|",depth 4; flowbits:set,file.class; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20493; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY compressed Adobe Shockwave Flash file magic detected"; flow:to_client,established; file_data; content:"CWS",depth 3; byte_test:1,>=,0x06,0,relative; flowbits:set,file.cws; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20495; rev:23; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detected"; flow:to_client,established; file_data; content:"FWS",depth 3; byte_test:1,<,0x20,0,relative; isdataat:5,relative; content:!"|00 00 00 00|",within 4,distance 1; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20496; rev:26; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"moov",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20500; rev:20; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"ftyp",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20501; rev:20; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"mdat",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20502; rev:20; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"free",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20503; rev:20; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detected"; flow:to_client,established; file_data; content:"XFIR",depth 4; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20507; rev:22; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY bcproj file magic detected"; flow:to_client,established; file_data; content:"beat",depth 4; flowbits:set,file.bcproj; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20511; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY mx4 file magic detected"; flow:to_client,established; file_data; content:"MXC3",depth 4; flowbits:set,file.mx4; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20512; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ffmpeg file magic detected"; flow:to_client,established; file_data; content:"4XMV",depth 4; flowbits:set,file.ffmpeg; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20513; rev:17; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY dmg file magic detected"; flow:to_client,established; file_data; content:"ER|02 00|",depth 4; flowbits:set,file.dmg; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20514; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ivr file magic detected"; flow:to_client,established; file_data; content:".R1M",depth 4; flowbits:set,file.ivr; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20515; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY caff file magic detected"; flow:to_client,established; file_data; content:"caff|00 01 00 00|",depth 8; flowbits:set,file.caff; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20516; rev:15; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY vmd file magic detected"; flow:to_client,established; file_data; content:"|2E 03 00 00 01|",depth 5; flowbits:set,file.vmd; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20520; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Flac file magic detected"; flow:to_client,established; file_data; content:"fLaC",depth 4; flowbits:set,file.flac; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.flac; classtype:misc-activity; sid:20521; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Office Excel xlw file magic detected"; flow:to_client,established; file_data; content:"|09 04 06 00 00 04 00 01|",depth 8; flowbits:set,file.xls; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:12283; rev:26; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Windows Media ASF file magic detected"; flow:to_client,established; file_data; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|",depth 16; flowbits:set,file.asf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:12454; rev:23; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft asf file magic detected"; flow:to_client,established; file_data; content:"0&|B2|u",depth 4; flowbits:set,file.asf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:16143; rev:27; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Tiff little endian file magic detected"; flow:to_client,established; file_data; content:"II|2A 00|",depth 4; flowbits:set,file.tiff.little; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:17229; rev:26; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Tiff big endian file magic detected"; flow:to_client,established; file_data; content:"MM|00 2A|",depth 4; flowbits:set,file.tiff.big; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:17230; rev:31; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY OLE document file magic detected"; flow:to_client,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|",depth 8; flowbits:set,file.ole; flowbits:set,file.fpx; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:17314; rev:27; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY RealNetworks Realplayer REC file magic detected"; flow:to_client,established; file_data; content:".rec|00|",depth 5; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:19128; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY RealNetworks Realplayer .r1m file magic detected"; flow:to_client,established; file_data; content:".r1m",depth 4; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:19129; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY M3U file magic detected"; flow:to_client,established; file_data; content:"|23|EXTM3U",depth 7; flowbits:set,file.m3u; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.m3u; classtype:misc-activity; sid:9845; rev:25; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY PICT file magic detected"; flow:to_client,established; file_data; content:"PICT",depth 4; flowbits:set,file.pct; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:19907; rev:19; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY amf file magic detected"; flow:to_client,established; file_data; content:"AMF",depth 3; flowbits:set,file.amf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20564; rev:15; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY CDR file magic detected"; flow:to_client,established; file_data; content:"RIFF",depth 4,fast_pattern; content:"CDR",within 3,distance 4; flowbits:set,file.cdr; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/CorelDRAWCDR_file_format; classtype:misc-activity; sid:20589; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY webm file magic detected"; flow:to_client,established; file_data; content:"|1A 45 DF A3|",depth 4; content:"webm",within 4,distance 27; flowbits:set,file.webm; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20750; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Autodesk Maya file magic detected"; flow:to_client,established; file_data; content:"//Maya",depth 6; flowbits:set,file.autodesk_ma; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20860; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MIDI file magic detected"; flow:to_client,established; file_data; content:"MThd",depth 4; flowbits:set,file.mid; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20897; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY SMIL file magic detected"; flow:to_client,established; file_data; content:"<smil>",depth 6; flowbits:set,file.smil; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:20928; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"moof",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20950; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"mfra",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20951; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"skip",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20952; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"junk",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20953; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"wide",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20954; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"pnot",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20955; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"pict",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20956; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"meco",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20958; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_client,established; file_data; content:"uuid",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20959; rev:16; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY AVI Video file magic detected"; flow:to_client,established; file_data; content:"RIFF",depth 4; content:"AVI LIST",within 8,distance 4; flowbits:set,file.avi.video; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21059; rev:13; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY WAV file magic detected"; flow:to_client,established; file_data; content:"RIFF",depth 4; content:"WAVE",within 4,distance 4; flowbits:set,file.wav; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21620; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY AVI file magic detected"; flow:to_client,established; file_data; content:"RIFF",depth 4; content:"AVI ",within 4,distance 4; flowbits:set,file.avi; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21621; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ANI file magic detection"; flow:to_client,established; file_data; content:"RIFF",depth 4; content:"ACON",within 4,distance 4; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21727; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Apple Quicktime FLIC file magic detected"; flow:to_client,established; file_data; content:"|11 AF|",depth 2,offset 4; content:"|08 00|",within 2,distance 6; content:"|00 00 00 00|",within 4,distance 5; flowbits:set,file.fli; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21814; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY OpenType Font file magic detection"; flow:to_client,established; file_data; content:"OTTO",depth 4; flowbits:set,file.otf; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:21999; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY NAB file magic detected"; flow:to_client,established; file_data; content:"|EF BB BF|",depth 3; flowbits:set,file.nab; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:22946; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Windows WMF file magic detected"; flow:to_client,established; file_data; content:"|00 09 00 00|",depth 4,offset 1; byte_test:1,<=,2,0; flowbits:set,file.wmf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.wmf; classtype:misc-activity; sid:22999; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MPEG video stream file magic detected"; flow:to_server,established; file_data; content:"|00 00 01 B3|",depth 4; flowbits:set,file.mpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23639; rev:15; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MPEG sys stream file magic detected"; flow:to_server,established; file_data; content:"|00 00 01 BA|",depth 4; flowbits:set,file.mpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23640; rev:15; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Script encoder file magic detected"; flow:to_server,established; file_data; content:"|23 40 7E 5E|",depth 4; flowbits:set,file.screnc; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23642; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Postscript file magic detected"; flow:to_server,established; file_data; content:"|25 21 50 53 2D 41 64 6F 62 65 2D|",depth 11; flowbits:set,file.postscript; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23643; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY RealNetworks Real Media file magic detected"; flow:to_server,established; file_data; content:".RMF",depth 4; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23645; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY bzip file magic detected"; flow:to_server,established; file_data; content:"BZh",depth 3; flowbits:set,file.bzip; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23646; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY GIF file magic detected"; flow:to_server,established; file_data; content:"GIF8",depth 4,fast_pattern; content:"a",within 1,distance 1; flowbits:set,file.gif; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23647; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MP3 file magic detected"; flow:to_server,established; file_data; content:"ID3",depth 3; flowbits:set,file.mp3; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23648; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Microsoft Windows CAB file magic detected"; flow:to_server,established; file_data; content:"MSCF",depth 4; flowbits:set,file.cab; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23649; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Ogg Stream file magic detected"; flow:to_server,established; file_data; content:"OggS|00|",depth 5; flowbits:set,file.ogg; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23650; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|03 04|",depth 4; content:!"|14 00 06 00|",within 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23651; rev:15; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK00PK|03 04|",depth 8; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23652; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|01 02|",depth 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23653; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|05 06|",depth 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23654; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|06 08|",depth 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23655; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|06 07|",depth 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23656; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JAR/ZIP file magic detected"; flow:to_server,established; file_data; content:"PK|06 06|",depth 4; flowbits:set,file.zip; flowbits:set,file.jar; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23657; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY RIFX file magic detected"; flow:to_server,established; file_data; content:"RIFX",depth 4; flowbits:set,file.dir; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23658; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY RAR file magic detected"; flow:to_server,established; file_data; content:"Rar|21 1A 07|",depth 6; flowbits:set,file.rar; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23659; rev:17; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Symantec file magic detected"; flow:to_server,established; file_data; content:"X-Symantec-",depth 11; flowbits:set,file.symantec; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23660; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ARJ file magic detected"; flow:to_server,established; file_data; content:"|60 EA 00 00|",depth 4; flowbits:set,file.arj; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23661; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY TNEF file magic detected"; flow:to_server,established; file_data; content:"x|9F|>|22|",depth 4; flowbits:set,file.tnef; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23662; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ELF file magic detected"; flow:to_server,established; file_data; content:"|7F|ELF",depth 4; flowbits:set,file.elf; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23663; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY PNG file magic detected"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|",depth 8; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23664; rev:17; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MP3 file magic detected"; flow:to_server,established; file_data; content:"|FF FB|",depth 2; flowbits:set,file.mp3; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23666; rev:15; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_server,established; file_data; content:"|FF D8 FF E0|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23667; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_server,established; file_data; content:"|FF D8 FF E1|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:24457; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JPEG file magic detected"; flow:to_server,established; file_data; content:"|FF D8 FF EE|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:24458; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY SIS file magic detected"; flow:to_server,established; file_data; content:"|19 04 00 10|",depth 4; flowbits:set,file.sis; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23668; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY SIP log file magic detected"; flow:to_server,established; file_data; content:"SIP-HIT (SIP/H",depth 14; flowbits:set,file.siplog; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23669; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY 7zip file magic detected"; flow:to_server,established; file_data; content:"7z|BC AF 27 1C|",depth 6; flowbits:set,file.7zip; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23671; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MachO Little Endian file magic detected"; flow:to_server,established; file_data; content:"|CE FA ED FE|",depth 4; flowbits:set,file.machole; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23672; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MachO x64 Little Endian file magic detected"; flow:to_server,established; file_data; content:"|CF FA ED FE|",depth 4; flowbits:set,file.macho64le; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23673; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MachO Big Endian file magic detected"; flow:to_server,established; file_data; content:"|FE ED FA CE|",depth 4; flowbits:set,file.machobe; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23674; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MachO x64 Big Endian file magic detected"; flow:to_server,established; file_data; content:"|FE ED FA CF|",depth 4; flowbits:set,file.macho64be; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23675; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Universal Binary/Java Bytecode file magic detected"; flow:to_server,established; file_data; content:"|CA FE BA BE|",depth 4; flowbits:set,file.universalbinary; flowbits:set,file.class; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23676; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY jarpack file magic detected"; flow:to_server,established; file_data; content:"|CA FE D0 0D|",depth 4; flowbits:set,file.class; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23677; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY compressed Adobe Shockwave Flash file magic detected"; flow:to_server,established; file_data; content:"CWS",depth 3; byte_test:1,>=,0x06,0,relative; flowbits:set,file.cws; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23679; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"moov",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23682; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"ftyp",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23683; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"mdat",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23684; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"free",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23685; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detected"; flow:to_server,established; file_data; content:"XFIR",depth 4; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23687; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY bcproj file magic detected"; flow:to_server,established; file_data; content:"beat",depth 4; flowbits:set,file.bcproj; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23688; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY mx4 file magic detected"; flow:to_server,established; file_data; content:"MXC3",depth 4; flowbits:set,file.mx4; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23689; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ffmpeg file magic detected"; flow:to_server,established; file_data; content:"4XMV",depth 4; flowbits:set,file.ffmpeg; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23690; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY dmg file magic detected"; flow:to_server,established; file_data; content:"ER|02 00|",depth 4; flowbits:set,file.dmg; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23691; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ivr file magic detected"; flow:to_server,established; file_data; content:".R1M",depth 4; flowbits:set,file.ivr; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23692; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY caff file magic detected"; flow:to_server,established; file_data; content:"caff|00 01 00 00|",depth 8; flowbits:set,file.caff; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23693; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY vmd file magic detected"; flow:to_server,established; file_data; content:"|2E 03 00 00 01|",depth 5; flowbits:set,file.vmd; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23694; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Flac file magic detected"; flow:to_server,established; file_data; content:"fLaC",depth 4; flowbits:set,file.flac; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/.flac; classtype:misc-activity; sid:23695; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Microsoft Office Excel xlw file magic detected"; flow:to_server,established; file_data; content:"|09 04 06 00 00 04 00 01|",depth 8; flowbits:set,file.xls; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:23697; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Microsoft Windows Media ASF file magic detected"; flow:to_server,established; file_data; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|",depth 16; flowbits:set,file.asf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:23698; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Microsoft asf file magic detected"; flow:to_server,established; file_data; content:"0&|B2|u",depth 4; flowbits:set,file.asf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:23703; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Tiff little endian file magic detected"; flow:to_server,established; file_data; content:"II|2A 00|",depth 4; flowbits:set,file.tiff.little; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:23709; rev:16; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Tiff big endian file magic detected"; flow:to_server,established; file_data; content:"MM|00 2A|",depth 4; flowbits:set,file.tiff.big; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:23710; rev:19; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY OLE Document file magic detected"; flow:to_server,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|",depth 8; flowbits:set,file.ole; flowbits:set,file.fpx; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:23711; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY RealNetworks Realplayer REC file magic detected"; flow:to_server,established; file_data; content:".rec|00|",depth 5; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:23720; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY RealNetworks Realplayer .r1m file magic detected"; flow:to_server,established; file_data; content:".r1m",depth 4; flowbits:set,file.realplayer; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:23721; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY M3U file magic detected"; flow:to_server,established; file_data; content:"|23|EXTM3U",depth 7; flowbits:set,file.m3u; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/.m3u; classtype:misc-activity; sid:23723; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY PICT file magic detected"; flow:to_server,established; file_data; content:"PICT",depth 4; flowbits:set,file.pct; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23729; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY amf file magic detected"; flow:to_server,established; file_data; content:"AMF",depth 3; flowbits:set,file.amf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23730; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY CDR file magic detected"; flow:to_server,established; file_data; content:"RIFF",depth 4,fast_pattern; content:"CDR",within 3,distance 4; flowbits:set,file.cdr; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/CorelDRAWCDR_file_format; classtype:misc-activity; sid:23731; rev:8; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY webm file magic detected"; flow:to_server,established; file_data; content:"|1A 45 DF A3|",depth 4; content:"webm",within 4,distance 27; flowbits:set,file.webm; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23733; rev:7; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Autodesk Maya file magic detected"; flow:to_server,established; file_data; content:"//Maya",depth 6; flowbits:set,file.autodesk_ma; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23734; rev:8; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MIDI file magic detected"; flow:to_server,established; file_data; content:"MThd",depth 4; flowbits:set,file.mid; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23735; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY SMIL file magic detected"; flow:to_server,established; file_data; content:"<smil>",depth 6; flowbits:set,file.smil; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:23737; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"moof",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23738; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"mfra",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23739; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"skip",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23740; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"junk",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23741; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"wide",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23742; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"pnot",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23743; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"pict",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23744; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"meco",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23746; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MOV file magic detected"; flow:to_server,established; file_data; content:"uuid",depth 4,offset 4; flowbits:set,file.quicktime; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23747; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY AVI Video file magic detected"; flow:to_server,established; file_data; content:"RIFF",depth 4; content:"AVI LIST",within 8,distance 4; flowbits:set,file.avi.video; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23754; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY WAV file magic detected"; flow:to_server,established; file_data; content:"RIFF",depth 4; content:"WAVE",within 4,distance 4; flowbits:set,file.wav; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23760; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY AVI file magic detected"; flow:to_server,established; file_data; content:"RIFF",depth 4; content:"AVI ",within 4,distance 4; flowbits:set,file.avi; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23761; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Apple Quicktime FLIC file magic detected"; flow:to_server,established; file_data; content:"|11 AF|",depth 2,offset 4; content:"|08 00|",within 2,distance 6; content:"|00 00 00 00|",within 4,distance 5; flowbits:set,file.fli; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23765; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY NAB file magic detected"; flow:to_server,established; file_data; content:"|EF BB BF|",depth 3; flowbits:set,file.nab; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:23774; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY JPEG2000 file magic detected"; flow:to_client,established; file_data; content:"|00 00 00 0C 6A 50 20 20|",depth 8; flowbits:set,file.jp2; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:23822; rev:14; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JPEG2000 file magic detected"; flow:to_server,established; file_data; content:"|00 00 00 0C 6A 50 20 20|",depth 8; flowbits:set,file.jp2; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:23823; rev:14; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY X PixMap file magic detected"; flow:to_client,established; file_data; content:"/* XPM */",depth 9; flowbits:set,file.xpm; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24190; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MP4 file magic detected"; flow:to_client,established; file_data; content:"ftypmp4",depth 7,offset 4; flowbits:set,file.mp4; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24213; rev:13; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY SMIL file magic detected"; flow:to_client,established; file_data; content:"SMILtext",depth 8; flowbits:set,file.smil; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:24218; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY SMIL file magic detected"; flow:to_server,established; file_data; content:"SMILtext",depth 8; flowbits:set,file.smil; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:24219; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY PSD file magic detection"; flow:to_client,established; content:"8BPS|00 01|",depth 6; flowbits:set,file.psd; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24462; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY PSD file magic detection"; flow:to_server,established; content:"8BPS|00 01|",depth 6; flowbits:set,file.psd; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:24466; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Microsoft Windows WMF file magic detected"; flow:to_server,established; file_data; content:"|00 09 00 00|",depth 4,offset 1; byte_test:1,<=,2,0; flowbits:set,file.wmf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/.wmf; classtype:misc-activity; sid:24465; rev:13; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY XCF file magic detection"; flow:to_client,established; content:"gimp xcf ",depth 9; flowbits:set,file.xcf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24470; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY XCF file magic detection"; flow:to_server,established; content:"gimp xcf ",depth 9; flowbits:set,file.xcf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:24471; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY rmf file download request"; flow:established,to_client; file_data; content:"IREZ",depth 4; flowbits:set,file.rmf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:bugtraq,39077; reference:cve,2010-0842; classtype:attempted-user; sid:24509; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY MP4 file magic detected"; flow:to_client,established; file_data; content:"ftypiso",depth 7,offset 4; content:"mp4",within 3,distance 5; flowbits:set,file.mp4; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24816; rev:12; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY MP4 file magic detected"; flow:to_server,established; file_data; content:"ftypiso",depth 7,offset 4; content:"mp4",within 3,distance 5; flowbits:set,file.mp4; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:24817; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY M4V file magic detected"; flow:to_client,established; file_data; content:"ftypM4V",depth 7,offset 4,nocase; flowbits:set,file.m4v; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:24818; rev:11; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY M4V file magic detected"; flow:to_server,established; file_data; content:"ftypM4V",depth 7,offset 4,nocase; flowbits:set,file.m4v; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:24819; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Adobe Audition Session file magic detected"; flow:to_client,established; file_data; content:"|43 4F 4F 4C 4E 45 53 53|",depth 8; flowbits:set,file.ses; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:25305; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ZIP file download detected"; flow:to_client,established; file_data; content:"PK|03 04 14 00 06 00|",depth 8; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:26057; rev:13; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ZIP file attachment detected"; flow:to_server,established; file_data; content:"PK|03 04 14 00 06 00|",depth 8; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:26058; rev:12; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Python bytecode file magic detected"; flow:to_client,established; file_data; content:"|03 F3 0D 0A|",depth 4; flowbits:set,file.pyc; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:27542; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"FILE-IDENTIFY Python bytecode file magic detected"; flow:to_server,established; file_data; content:"|03 F3 0D 0A|",depth 4; flowbits:set,file.pyc; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:27543; rev:7; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY WordPerfect file magic detected"; flow:to_client,established; file_data; content:"|FF|WPC",depth 4; flowbits:set,file.corel; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,www.magicdb.org/magic.db; classtype:misc-activity; sid:28497; rev:7; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY OS/2 Metafile file magic detected"; flow:to_client,established; file_data; content:"|D3 A8 A8|",depth 3,offset 2; flowbits:set,file.met; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/Comparison_of_graphics_file_formats; classtype:misc-activity; sid:30014; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"FILE-IDENTIFY OS/2 Metafile file magic detected"; flow:to_server,established; file_data; content:"|D3 A8 A8|",depth 3,offset 2; flowbits:set,file.met; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,en.wikipedia.org/wiki/Comparison_of_graphics_file_formats; classtype:misc-activity; sid:30017; rev:8; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY ABC Music Notation file attachment detected"; flow:to_client,established; file_data; content:"%abc",depth 4; flowbits:set,file.abc; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; reference:url,abcnotation.com/wiki/abc:standard:v2.1.1; classtype:misc-activity; sid:30756; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY ABC Music Notation file attachment detected"; flow:to_server,established; file_data; content:"%abc",depth 4; flowbits:set,file.abc; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; reference:url,abcnotation.com/wiki/abc:standard:v2.1.1; classtype:misc-activity; sid:30757; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY JPEG file magic detection"; flow:to_server,established; file_data; content:"|FF D8 FF|",depth 3; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:31871; rev:11; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY JPEG file magic detection"; flow:to_client,established; file_data; content:"|FF D8 FF|",depth 3; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:20480; rev:21; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY SVG file magic detected"; flow:to_client,established; file_data; content:"<svg ",depth 5; flowbits:set,file.svg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,en.wikipedia.org/wiki/.svg; classtype:misc-activity; sid:32165; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Journal file download attempt"; flow:to_client,established; file_data; content:"NB|2A 00|",depth 4,nocase; flowbits:set,file.jnt; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:34398; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY GNI file magic detected"; flow:to_client,established; file_data; content:"AGNI",depth 4; flowbits:set,file.gni; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:35250; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY M4A file magic detected"; flow:to_client,established; file_data; content:"ftypM4A",depth 7,offset 4; flowbits:set,file.mp4; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:35432; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY M4A file magic detected"; flow:to_server,established; file_data; content:"ftypM4A",depth 7,offset 4; flowbits:set,file.mp4; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:35433; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Adobe LZMA compressed Flash file magic detected"; flow:to_client,established; file_data; content:"ZWS",depth 3; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:35455; rev:9; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Adobe LZMA compressed Flash file magic detected"; flow:to_server,established; file_data; content:"ZWS",depth 3; flowbits:set,file.swf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; classtype:misc-activity; sid:35458; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"FILE-IDENTIFY JPEG file upload detected"; flow:to_server,established; file_data; content:"|FF D8 FF E1|",depth 4; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:http; classtype:misc-activity; sid:35852; rev:9; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY XLSB file magic detected"; flow:to_client,established; file_data; content:"PK|03 04|",depth 4; flowbits:set,file.zip; flowbits:set,file.xlsb; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:40035; rev:10; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY XLSB file magic detected"; flow:to_server,established; file_data; content:"PK|03 04|",depth 4; flowbits:set,file.zip; flowbits:set,file.xlsb; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:40036; rev:10; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Windows registry hive file magic detected"; flow:to_client,established; file_data; content:"regf",depth 4; flowbits:set,file.regf; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:40387; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Windows registry hive file magic detected"; flow:to_server,established; file_data; content:"regf",depth 4; flowbits:set,file.regf; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:40390; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY bzip2 compressed file detected"; flow:to_client,established; file_data; content:"BZh",depth 3; byte_test:1,<,10,0,relative,string,dec; flowbits:set,file.bz2; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:42363; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"FILE-IDENTIFY bzip2 compressed file detected"; flow:to_server,established; file_data; content:"BZh",depth 3; byte_test:1,<,10,0,relative,string,dec; flowbits:set,file.bz2; flowbits:noalert; metadata:policy max-detect-ips alert; service:http; classtype:misc-activity; sid:42364; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY bzip2 compressed file detected"; flow:to_server,established; file_data; content:"BZh",depth 3; byte_test:1,<,10,0,relative,string,dec; flowbits:set,file.bz2; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:42365; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY XZ compressed file detected"; flow:to_client,established; file_data; content:"|FD|7zXZ|00|",depth 6; flowbits:set,file.xz; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:42366; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"FILE-IDENTIFY XZ compressed file detected"; flow:to_server,established; file_data; content:"|FD|7zXZ|00|",depth 6; flowbits:set,file.xz; flowbits:noalert; metadata:policy max-detect-ips alert; service:http; classtype:misc-activity; sid:42367; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY XZ compressed file detected"; flow:to_server,established; file_data; content:"|FD|7zXZ|00|",depth 6; flowbits:set,file.xz; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:42368; rev:5; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY gzip compressed file detected"; flow:to_client,established; file_data; content:"|1F 8B|",depth 2; byte_test:1,<=,8,0,relative; flowbits:set,file.gz; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:42369; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"FILE-IDENTIFY gzip compressed file detected"; flow:to_server,established; file_data; content:"|1F 8B|",depth 2; byte_test:1,<=,8,0,relative; flowbits:set,file.gz; flowbits:noalert; metadata:policy max-detect-ips alert; service:http; classtype:misc-activity; sid:42370; rev:6; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY gzip compressed file detected"; flow:to_server,established; file_data; content:"|1F 8B|",depth 2; byte_test:1,<=,8,0,relative; flowbits:set,file.gz; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:42371; rev:6; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Blender blend file magic detected"; flow:to_client,established; file_data; content:"BLENDER_v",depth 9; flowbits:set,file.blend.little.32; flowbits:noalert; metadata:policy security-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:44441; rev:4; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Blender blend file magic detected"; flow:to_server,established; file_data; content:"BLENDER_v",depth 9; flowbits:set,file.blend.little.32; flowbits:noalert; metadata:policy security-ips alert; service:smtp; classtype:misc-activity; sid:44442; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY WebAssembly file download detected"; flow:to_client,established; file_data; content:"|00|asm|01 00 00 00|",depth 8; flowbits:set,file.wasm; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:ftp-data, http, imap, pop3; reference:url,github.com/WebAssembly/design/blob/master/BinaryEncoding.md; classtype:misc-attack; sid:46367; rev:5; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY WebAssembly file detected"; flow:to_server,established; file_data; content:"|00|asm|01 00 00 00|",depth 8; flowbits:set,file.wasm; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; service:smtp; reference:url,github.com/WebAssembly/design/blob/master/BinaryEncoding.md; classtype:misc-attack; sid:46393; rev:4; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY Fax Cover Page file magic detected"; flow:to_client,established; file_data; content:"FAXCOVER",depth 8; flowbits:set,file.cov; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:50874; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY Fax Cover Page file magic detected"; flow:to_server,established; file_data; content:"FAXCOVER",depth 8; flowbits:set,file.cov; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:misc-activity; sid:50875; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IDENTIFY BIMx file magic detected"; flow:to_client,established; file_data; content:"BIMx",depth 4; flowbits:set,file.bimx; flowbits:noalert; service:ftp-data, http, imap, pop3; classtype:misc-activity; sid:53569; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IDENTIFY BIMx file magic detected"; flow:to_server,established; file_data; content:"BIMx",depth 4; flowbits:set,file.bimx; flowbits:noalert; service:smtp; classtype:misc-activity; sid:53570; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IMAGE Microsoft Windows asycfilt.dll malformed jpeg buffer overread attempt"; flow:to_client,established; file_data; isdataat:!14; content:"|FF D8 FF E0 00 10|",depth 6; isdataat:1,relative; content:!"|4A 46|",within 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-7212; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-130; classtype:attempted-user; sid:40645; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IMAGE Microsoft Windows asycfilt.dll malformed jpeg buffer overread attempt"; flow:to_server,established; file_data; isdataat:!14; content:"|FF D8 FF E0 00 10|",depth 6; isdataat:1,relative; content:!"|4A 46|",within 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-7212; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-130; classtype:attempted-user; sid:40646; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|",depth 2; content:"Exif",within 4,distance 20; content:"MM",within 2,distance 2; byte_jump:4,2,relative,post_offset -4; byte_test:2,>,12,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43095; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|",depth 2; content:"Exif",within 4,distance 20; content:"MM",within 2,distance 2; byte_jump:4,2,relative,post_offset -4; byte_test:2,>,12,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43096; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|",depth 2; content:"Exif",within 4,distance 20; content:"II",within 2,distance 2; byte_jump:4,2,relative,little,post_offset -4; byte_test:2,>,12,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43097; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|",depth 2; content:"Exif",within 4,distance 20; content:"II",within 2,distance 2; byte_jump:4,2,relative,little,post_offset -4; byte_test:2,>,12,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43098; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_client,established; file_data; content:"|FF 4F FF 51|",depth 4; byte_test:4,>,0x3b9aca00,20,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43908; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_client,established; file_data; content:"|FF 4F FF 51|",depth 4; byte_test:4,>,0x3b9aca00,24,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43909; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_server,established; file_data; content:"|FF 4F FF 51|",depth 4; byte_test:4,>,0x3b9aca00,20,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43910; rev:3; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_server,established; file_data; content:"|FF 4F FF 51|",depth 4; byte_test:4,>,0x3b9aca00,24,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43911; rev:3; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-OFFICE RFT document malformed header"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|7B 5C|rtvpn",depth 7; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data, http, imap, pop3; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:38580; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-OFFICE RFT document malformed header"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|7B 5C|rtvpn",depth 7; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:38581; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-OFFICE RTF document incorrect file magic attempt"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|7B 5C|rt|0D 3C|",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data, http, imap, pop3; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39526; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-OFFICE RTF document incorrect file magic attempt"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|7B 5C|rt|0D 3C|",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; reference:cve,2015-1641; reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033; classtype:attempted-user; sid:39527; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-OTHER Microsoft Internet Explorer malformed ico integer overflow attempt"; flow:to_client,established; flowbits:isset,file.ico; file_data; content:"|00 00 01 00 FF FF|",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2016-7272; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-146; classtype:attempted-admin; sid:40982; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"FILE-OTHER Microsoft LNK remote code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.lnk; content:"|4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|",depth 20,fast_pattern; byte_test:1,&,0x1,0,relative; byte_test:2,>,0x2710,76,little; isdataat:2000,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2018-8345; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8345; classtype:attempted-admin; sid:47476; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"FILE-OTHER Microsoft LNK remote code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.lnk; content:"|4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|",depth 20,fast_pattern; byte_test:1,&,0x1,0,relative; byte_test:2,>,0x2710,76,little; isdataat:2000,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2018-8345; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8345; classtype:attempted-admin; sid:47477; rev:1; )
alert tcp any any -> any 445 ( msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_server,established; content:"|FF|SMB|2D|",depth 5,offset 4; content:"|0F FF 00|",within 3,distance 27; content:"|16 00 20 00 40 9D C1 57 01 00|",within 10,distance 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50466; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 69 ( msg:"INDICATOR-SCAN Cisco Smart Install Protocol scan TFTP response"; flow:to_server; dsize:20; content:"|00 01|random_file|00|octet|00|",depth 20; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:tftp; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-recon; sid:41793; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-BACKDOOR Win.Backdoor.Tinrot.A runtime detection"; flow:to_server,established; content:"|A0 00 00 00|",depth 4; content:"|98 00 00 00|",within 4,distance 4; isdataat:163; isdataat:!164; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/e181424c4fb8bcde4aae154bf3ecb14d/detection; classtype:trojan-activity; sid:23341; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR evilotus 1.3.2 runtime detection - init connection"; flow:to_client,established; flowbits:set,Evilotus_detection; content:"|0C|~|7F D8 13 00 00 00|d|C8 00 00 0B 00 00 00 07 00 00 00 80 E7 03 0C|~|7F D8|",depth 27; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:13506; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR yuri 1.2 runtime detection - init connection"; flow:to_client,established; content:"Req_Conn",depth 8,nocase; flowbits:set,Yuri_1_2_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:13247; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR bandook 1.35 runtime detection"; flow:to_server,established; content:"|CF 8F 80 9B 9A 9D CF C9 CA C9 D9 8D C9|",depth 13; flowbits:set,Bandook135_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12726; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR dark moon 4.11 runtime detection"; flow:to_client,established; content:"1DbsLbE3i/MBQu9Z",depth 16; flowbits:set,DarkMoon411_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12724; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR poison ivy 2.3.0 runtime detection - init connection"; flow:to_client,established; content:"|B9 E1 A5|~|C7 B7 82|n|22|n|0B CB FD|w|ED|I",depth 16; flowbits:set,PoisonIvy2.3.0_initDetection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12699; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR shark 2.3.2 runtime detection"; flow:to_server,established; content:"F|15 1D|",depth 3; flowbits:set,sharK_2.3.2_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12377; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR radmin 3.0 runtime detection - login & remote control"; flow:to_server,established; content:"|01 00 00 00 05 00 00 02|''|02 00 00 00|",depth 14; flowbits:set,Radmin3.0_login_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12375; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR radmin 3.0 runtime detection - initial connection"; flow:to_server,established; content:"|01 00 00 00 01 00 00 00 08 08|",depth 10; flowbits:set,Radmin3.0_conn_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12373; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR bifrost v1.2.1 runtime detection"; flow:to_client,established; content:"|05 00 00 00 BC|",depth 5; content:"|CC|",within 1,distance 3; flowbits:set,Bifrost_v1.2.1_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12297; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR hotmail hacker log edition 5.0 runtime detection - init connection"; flow:to_server,established; content:"Start",depth 5,nocase; pcre:"/^Start$/smi"; flowbits:set,HotmailHackerLogEdition5.0_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12242; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR theef 2.10 runtime detection - connect with password"; flow:to_client,established; content:"|FA CB D9 D9 DD C5 D8 CE D6|",depth 9; flowbits:set,Theef210_Connectionwithpassword; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12235; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR theef 2.10 runtime detection - connect with no password"; flow:to_client,established; content:"|FA CB D9 D9 E5 E1 D6|",depth 7; flowbits:set,Theef210_Connectionwithnopassword; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12233; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1357 ( msg:"MALWARE-BACKDOOR cobra uploader 1.0 runtime detection"; flow:to_server,established; content:"DIR",depth 3,offset 3; pcre:"/^(SYS|WIN)DIR$/sm"; flowbits:set,CobraUploader1.0_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12163; rev:5; )
alert tcp $HOME_NET 503 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - screen capturing"; flow:to_client,established; flowbits:isset,OptixPROv1.32Screencapture_detection1; content:" |0D 0A|",depth 3; flowbits:set,OptixPROv1.32Screencapture_detection2; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12161; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 503 ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - screen capturing"; flow:to_server,established; content:"SendACap|AC|",depth 9; flowbits:set,OptixPROv1.32Screencapture_detection1; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12160; rev:5; )
alert tcp $HOME_NET 501 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - upload file"; flow:to_client,established; flowbits:isset,OptixPROv1.32Upload_detection1; content:" |0D 0A|",depth 3; flowbits:set,OptixPROv1.32Upload_detection2; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12157; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 501 ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - upload file"; flow:to_server,established; content:"InfoOn|AC|",depth 7; flowbits:set,OptixPROv1.32Upload_detection1; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12156; rev:5; )
alert tcp $HOME_NET 500 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - download file"; flow:to_client,established; flowbits:isset,OptixPROv1.32Download_detection1; content:"+OK REDY|0D 0A|",depth 10; flowbits:set,OptixPROv1.32Download_detection2; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12154; rev:6; )
alert tcp $HOME_NET 500 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR optix pro v1.32 runtime detection - download file"; flow:to_client,established; content:" |0D 0A|",depth 3; flowbits:set,OptixPROv1.32Download_detection1; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12153; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR cafeini 1.0 runtime detection - init connection"; flow:to_client,established; content:"|FF FD 03 FF FD 18 FF FD 1F|",depth 9; flowbits:set,CAFEiNi_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12150; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 54320 ( msg:"MALWARE-BACKDOOR back orifice 2006 - v1.1.5 runtime detection - init connection"; flow:to_server,established; content:"|00 00 00|",depth 3; content:"|CD C3 13|7",within 4,distance 1; flowbits:set,BackOrifice2006_1.1.5_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12148; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR blue eye 1.0b runtime detection - init connection"; flow:to_server,established; content:"AUTH",depth 4; flowbits:set,BlueEye1.0b_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12146; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-BACKDOOR access remote pc runtime detection - rpc setup"; flow:to_server,established; content:"|99 F3 00 00 00 00 00 00 FF FF FF FF|",depth 12; flowbits:set,AccessRemotePC_RPCdetection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12144; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR access remote pc runtime detection - init connection"; flow:to_server,established; content:"|99 F3 00 00 00 00 00 00 FF FF FF FF|",depth 12; flowbits:set,AccessRemotePC_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12142; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 58008 ( msg:"MALWARE-BACKDOOR tron runtime detection - init connection - flowbit set"; flow:to_server,established; content:"<SYSTMTIME>",depth 11,nocase; flowbits:set,Tron_Initconnection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:12054; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 610 ( msg:"MALWARE-BACKDOOR supervisor plus runtime detection"; flow:to_server,established; content:"L",depth 1,nocase; content:"|00|",depth 1,offset 3; pcre:"/^L\d\d\x00/smi"; flowbits:set,SupervisorPlus_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:11953; rev:5; )
alert tcp $HOME_NET 5712 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR sohoanywhere runtime detection"; flow:to_client,established; content:"RFB 003.003|0A|",depth 12,nocase; flowbits:set,Sohoanywhere_Init; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:11322; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 12667 ( msg:"MALWARE-BACKDOOR winicabras 1.1 runtime detection - explorer"; flow:to_server,established; content:"DRIVE",depth 5,nocase; flowbits:set,Winicabras_explorer; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10462; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3132 ( msg:"MALWARE-BACKDOOR winicabras 1.1 runtime detection - get system info"; flow:to_server,established; content:"000",depth 3; flowbits:set,Winicabras_getinfo; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10460; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5600 ( msg:"MALWARE-BACKDOOR [x]-ztoo 1.0 runtime detection - get system info"; flow:to_server,established; content:"GetInfo",depth 7,nocase; flowbits:set,XZTOO_Getinfo; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10455; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR poison ivy 2.1.2 runtime detection"; flow:to_client,established; content:"|F6 13 00 00|",depth 4; flowbits:set,PoisonIvy_init; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10110; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR hav-rat 1.1 runtime detection"; flow:to_server,established; flowbits:isset,HavRat_pcinfo1; content:"User|3A|",depth 5,nocase; flowbits:set,HavRat_pcinfo2; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10104; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR hav-rat 1.1 runtime detection"; flow:to_client,established; content:"getinfo",depth 7,nocase; flowbits:set,HavRat_pcinfo1; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:10103; rev:8; )
alert tcp $EXTERNAL_NET 877 -> $HOME_NET 876 ( msg:"MALWARE-BACKDOOR messiah 4.0 runtime detection - enable keylogger - flowbit set"; flow:established; content:"enablekey|7C|",depth 10; flowbits:set,Messiah_EnableKeyloggerA; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; classtype:trojan-activity; sid:7772; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR hornet 1.0 runtime detection - fetch process list - flowbit set"; flow:to_server,established; content:"008g",depth 4; isdataat:3; isdataat:!4; flowbits:set,hornet.4; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453073228; classtype:trojan-activity; sid:7635; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR hornet 1.0 runtime detection - fetch system info - flowbit set"; flow:to_server,established; content:"007r",depth 4; isdataat:3; isdataat:!4; flowbits:set,hornet.2; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453073228; classtype:trojan-activity; sid:7631; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR fearless lite 1.01 runtime detection"; flow:to_client,established; flowbits:isset,backdoor.fearless.runtime; content:"Pass-On0",depth 8,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,www.megasecurity.org/trojans/f/fearless/Fearless_lite1.01.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453078381; classtype:trojan-activity; sid:7112; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR fearless lite 1.01 runtime detection"; flow:to_server,established; content:"Pass-On",depth 7,nocase; flowbits:set,backdoor.fearless.runtime; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy security-ips alert; reference:url,www.megasecurity.org/trojans/f/fearless/Fearless_lite1.01.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453078381; classtype:trojan-activity; sid:7111; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21554 ( msg:"MALWARE-BACKDOOR girlfriend runtime detection"; flow:to_server,established; content:"ver",depth 3,nocase; flowbits:set,GirlFriend.1.35.connection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,www.megasecurity.org/trojans/g/girlfriend/GirlFriend1.35_ms.html; reference:url,www.spywareguide.com/product_show.php?id=834; classtype:trojan-activity; sid:7106; rev:5; )
alert tcp $HOME_NET 30029 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR aol admin runtime detection"; flow:to_client,established; content:"AOL Admin Server 1.1 By CHeeSeR",depth 31,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.megasecurity.org/trojans/a/aoladmin/Aoladmin1.1.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=313; classtype:trojan-activity; sid:7105; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 30029 ( msg:"MALWARE-BACKDOOR aol admin runtime detection"; flow:to_server,established; content:"INFO",depth 4,nocase; flowbits:set,AOLAdmin1.1.connection; flowbits:noalert; reference:url,www.megasecurity.org/trojans/a/aoladmin/Aoladmin1.1.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=313; classtype:trojan-activity; sid:7104; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1480 ( msg:"MALWARE-BACKDOOR remote hack 1.5 runtime detection - logon"; flow:to_server,established; content:"logon|7C|",depth 6; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,www.spywareguide.com/product_show.php?id=1523; classtype:trojan-activity; sid:7096; rev:5; )
alert tcp $HOME_NET 5555 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR serveme runtime detection"; flow:to_client,established; content:"ServeMe 1.x",depth 11,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy security-ips drop; reference:url,www.megasecurity.org/trojans/s/serveme/Serveme.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453081036; classtype:trojan-activity; sid:7091; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2115 ( msg:"MALWARE-BACKDOOR bugs runtime detection - file manager client-to-server"; flow:to_server,established; content:"CURDIR|0D|",depth 7,nocase; flowbits:set,Bugs_InitConnection; flowbits:noalert; metadata:impact_flag red,policy max-detect-ips alert; reference:url,www.commodon.com/threat/threat-bugs.htm; reference:url,www.virustotal.com/gui/file/0590eaa0c8db54fb99904e52d4cf1797f158229438bf14f86d6bedabbb487414; classtype:trojan-activity; sid:6472; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR net demon runtime detection - file manager request"; flow:to_server,established; content:"GETLIST ",depth 8; pcre:"/^GETLIST\s+[^\r\n]*\n/sm"; flowbits:set,NetDemon_FileManager; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4029; classtype:trojan-activity; sid:6316; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR net demon runtime detection - open browser request"; flow:to_server,established; content:"openbrowser ",depth 12; pcre:"/^openbrowser\s+[^\r\n]*\n/sm"; flowbits:set,NetDemon_OpenBrowser; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4029; classtype:trojan-activity; sid:6314; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR net demon runtime detection - message send"; flow:to_server,established; content:"MSG ",depth 4; pcre:"/^MSG\s+[^\r\n]*\n/sm"; flowbits:set,NetDemon_Msg; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4029; classtype:trojan-activity; sid:6312; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR net demon runtime detection - initial connection - password request"; flow:to_client,established; content:"PWD|0A|",depth 4; flowbits:set,NetDemon_Init1; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4029; classtype:trojan-activity; sid:6309; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"MALWARE-BACKDOOR fade 1.0 runtime detection - enable keylogger"; flow:to_server,established; content:"877110",depth 6; flowbits:set,Fade_kl; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=453076292; classtype:trojan-activity; sid:6040; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5880 ( msg:"MALWARE-BACKDOOR Y3KRAT 1.5 Connect Client Response"; flow:to_server,established; flowbits:isset,backdoor.y3krat_15.connect; content:"getclient",depth 9; flowbits:set,backdoor.y3krat_15.client.response; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3082; rev:13; )
alert tcp $HOME_NET 5880 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Y3KRAT 1.5 Connect"; flow:to_client,established; content:"connected",depth 9; flowbits:set,backdoor.y3krat_15.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3081; rev:13; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-BACKDOOR Win.Backdoor.Demtranc variant outbound connection"; flow:to_server,established; content:"GET",depth 3,nocase; content:"/AES",within 4,distance 1,fast_pattern,nocase; pcre:"/^\d+O\d+\.jsp\?[a-z0-9\x3d\x2b\x2f]{20}/iR"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/file/b3a97be4160fb261e138888df276f9076ed76fe2efca3c71b3ebf7aa8713f4a4/analysis/; classtype:trojan-activity; sid:24116; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-BACKDOOR Win.Backdoor.Demtranc variant outbound connection"; flow:to_server,established; content:"GET",depth 3,nocase; content:"/ZES",within 4,distance 1,fast_pattern,nocase; pcre:"/^\d+O\d+\.jsp\?[a-z0-9\x3d\x2b\x2f]{20}/iR"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/file/b3a97be4160fb261e138888df276f9076ed76fe2efca3c71b3ebf7aa8713f4a4/analysis/; classtype:trojan-activity; sid:24118; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-BACKDOOR Win.Backdoor.Demtranc variant outbound connection"; flow:to_server,established; content:"GET",depth 3,nocase; content:"/SUS",within 4,distance 1,fast_pattern,nocase; pcre:"/^\d+O\d+\.jsp\?[a-z0-9\x3d\x2b\x2f]{20}/iR"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/file/b3a97be4160fb261e138888df276f9076ed76fe2efca3c71b3ebf7aa8713f4a4/analysis/; classtype:trojan-activity; sid:24120; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-BACKDOOR Win.Backdoor.Demtranc variant outbound connection"; flow:to_server,established; content:"GET",depth 3,nocase; content:"/DES",within 4,distance 1,fast_pattern,nocase; pcre:"/^\d+O\d+\.jsp\?[a-z0-9\x3d\x2b\x2f]{20}/iR"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/file/b3a97be4160fb261e138888df276f9076ed76fe2efca3c71b3ebf7aa8713f4a4/analysis/; classtype:trojan-activity; sid:24122; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.PCRat data upload"; flow:to_server,established; content:"PCRatd",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/en/file/669DF9DED24D56997D7B1EA6249BB704226DADA09230DC285AE66CA0C9B7247B/analysis/; classtype:misc-activity; sid:26655; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR AlienSpy RAT outbound connection"; flow:to_server,established; isdataat:16; isdataat:!17; content:"|75 72 00|",depth 3; content:"|02 00 00|",within 3,distance 11; flowbits:set,alienspy.rat; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,www.virustotal.com/en/file/d871121a10ca032b03157d38025248545559d2174804ba66165d18358eb98e8e/analysis/; classtype:trojan-activity; sid:32005; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR AlienSpy RAT outbound connection"; flow:to_server,established; flowbits:isset,alienspy.rat; content:"|78 70 00 00|",depth 4; content:"|1F 8B 08 00 00 00 00 00 00 00|",within 10,distance 2; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/d871121a10ca032b03157d38025248545559d2174804ba66165d18358eb98e8e/analysis/; classtype:trojan-activity; sid:32006; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53629 ( msg:"MALWARE-BACKDOOR Linux.Backdoor.Starysu variant inbound connection"; flow:to_server,established; content:"f|75|ckyO",depth 6; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/1b28b3256f7de74c1de6a254e3f69c784f8b356a25da024ffee722704056c9bd/analysis/; classtype:trojan-activity; sid:32080; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 58273 ( msg:"MALWARE-BACKDOOR Linux.Backdoor.Starysu variant inbound connection"; flow:to_server,established; content:"IAMYOURGOD",depth 10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/382f385fa57ea150393335385dc4e4e68647441914b037b5798a93b013570b53/analysis/; classtype:trojan-activity; sid:32081; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.Wekby Torn variant outbound connection"; flow:established, to_server; isdataat:15; isdataat:!16; content:"|00 00 00 11 C8 00 00 00 00 00 00 00 00 00 00 00|",depth 16,fast_pattern,fast_pattern_offset 0,fast_pattern_length 12; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/1D6BCF409C85887861D587C8AABFC8C8393EA692FE93C0A6836BE507A7F75985/analysis/; classtype:trojan-activity; sid:34500; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Adzok RAT inbound connection"; flow:to_client; isdataat:5; isdataat:!6; content:"|73 71 00 7E 00 00|",depth 6; flowbits:set,adzok.rat; flowbits:noalert; metadata:impact_flag red,policy max-detect-ips alert; reference:url,virustotal.com/en/file/a8ba7452c628c379f3e78b795e03f59426f9e8cb07fdd1b8866ea6fb9f093dc4/analysis/; classtype:trojan-activity; sid:37418; rev:4; )
alert tcp any any -> any any ( msg:"MALWARE-BACKDOOR Unix.Malware.Chaos backdoor trigger attempt"; flow:established,to_server; content:"j0DtFt1LTvbIU|00|",depth 14; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/e9fc1441bb88dd8cc7fcc2e176e53084ccd28f8766a017b3a07474b7e6b72ab9/detection; classtype:trojan-activity; sid:45975; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"MALWARE-BACKDOOR Win.Backdoor.NanoCore potential scanning attempt"; flow:to_server,established; isdataat:127; isdataat:!142; content:"|7F 40 00 00 00 DD|",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:52404; rev:1; )
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR PAS webshell outbound connection attempt"; flow:to_client,established; file_data; content:"<form action=|22 22| method=|22|post|22|><input type=|22|text|22| name=|22|",depth 55; content:"|22| value=|22 22|/><input type=|22|submit|22| value=|22|&gt|3B 22|/></form>",within 54,distance 5,fast_pattern; isdataat:!1,relative; pcre:"/<form action=\x22\x22 method=\x22post\x22><input type=\x22text\x22 name=\x22[a-z_]{5}\x22/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/gui/file/3f48d3f67956165a76f8eb39dd7ae19c35444526f2cf3af130525f76dfecff1b/detection; classtype:trojan-activity; sid:57362; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: ( msg:"MALWARE-CNC Win.Trojan.Linkbot.alr variant outbound connection"; flow:to_server,established; content:"USER|20|",depth 5; pcre:"/^USER\s(\S+)\s\1\s\1\s\x3A/m"; flowbits:set,trojan.linkbot_alr; flowbits:noalert; reference:url,www.virustotal.com/en/file/5c3129df82105d51cf621900710e53989442b8c8f692302faa08a130861c43d5/analysis/; classtype:trojan-activity; sid:19039; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 ( msg:"MALWARE-CNC Allaple.e variant outbound connection"; flow:to_server,established; content:"|05 00 0B|",depth 3; content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00 46|",within 16,distance 29; flowbits:set,backdoor.Allaple; flowbits:noalert; reference:url,www.virustotal.com/en/file/4b2eb0da416be0dca7c8f87edcc6f0363cd9651baf3d8b918c15ca8c06014716/analysis/; classtype:trojan-activity; sid:20001; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Defsel inbound connection"; flow:to_client,established; content:"MAININFO|7C|",depth 9,nocase; pcre:"/^MAININFO\x7c\d+\x0d\x0a/smi"; flowbits:set,backdoor.darkstrat; flowbits:noalert; reference:url,www.virustotal.com/en/file/c1134813519536396ab340e7170eaa00bcfc6c397269e40d7483fdae88b48b37/analysis/; classtype:trojan-activity; sid:19950; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Biodox inbound connection"; flow:to_client,established; content:"[GETSINFO]",depth 10,nocase; flowbits:set,backdoor_biodox; flowbits:noalert; reference:url,www.virustotal.com/en/file/4f13f17105c64cb817ad7f47960b0a673cd2767a513713312c8f50516f8e08ee/analysis/; classtype:trojan-activity; sid:19952; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 3070 ( msg:"MALWARE-CNC Virus.Win32.Parite.B variant outbound connection"; flow:to_server,established; content:"Status*|28|Idle...|29|*",depth 17,nocase; flowbits:set,parite.init; flowbits:noalert; reference:url,www.virustotal.com/en/file/d62e2e63beaa442c2dd527fa90775149f9a9e223f271236f6412ccc5cb73bccf/analysis/; classtype:trojan-activity; sid:19772; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC bugsprey variant inbound connection"; flow:to_client,established; isdataat:6; isdataat:!7; content:"GHOST|0D 0A|",depth 7,nocase; flowbits:set,BugsPrey_detection; flowbits:noalert; classtype:trojan-activity; sid:16093; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Keylogger outbound connection"; flow:to_server,established; http_uri; content:"/sizemore/css5.php?a",depth 20; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:cve,2014-0497; reference:url,attack.mitre.org/techniques/T1056; classtype:trojan-activity; sid:29615; rev:9; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Keylogger inbound connection"; flow:to_client,established; file_data; content:"787**KB",depth 7; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:cve,2014-0497; reference:url,attack.mitre.org/techniques/T1056; classtype:trojan-activity; sid:29616; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Spyrat variant inbound backdoor keep-alive"; flow:to_client,established; isdataat:!74; content:"ping|7C|",depth 5; flowbits:set,spyrat_bd; reference:url,www.virustotal.com/en/file/e64f536556739d50a673a952da7f110f1156fad0f7360d401794e5a8d65ce63a/analysis/; classtype:trojan-activity; sid:31144; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Linux.Backdoor.Ganiw variant outbound connection"; flow:to_server, established; content:"|F4 01 00 00 32 00 00 00 E8 03|",depth 10,offset 9; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/70afb98a09ca604f65f78a10ef72d2d05d17721f301c15b47a3e2437eefe1ed9/analysis/; classtype:trojan-activity; sid:32040; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [443,446,447] ( msg:"MALWARE-CNC Win.Trojan.Ramnit variant outbound detected"; flow:to_server,established; isdataat:!7; content:"|00 FF|",depth 2; content:"|00 00 00|",within 3,distance 1; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ssl; reference:url,www.virustotal.com/en/file/59852c486e6842b1901527baa3d96088065c1fac8a490031e7683c5d18340855/analysis/; reference:url,www.virustotal.com/en/file/83F75C8D52B84795A526CA7DAEA29186CDC2CDD4A33871A942BB00D673BB0E20/analysis/; classtype:trojan-activity; sid:33600; rev:3; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.Doublepulsar variant process injection command"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|",depth 9,offset 4; content:"|42 00|",within 2,distance 21; content:"|0E 00|",within 2,distance 29; content:!"|00 00|",within 2; flowbits:set,smb.trans2.mid66; metadata:impact_flag red,ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1055; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42331; rev:5; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.Doublepulsar variant ping command"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|",depth 9,offset 4; content:"|41 00|",within 2,distance 21; content:"|0E 00 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00|",within 17,distance 29,fast_pattern,fast_pattern_offset 0,fast_pattern_length 10; flowbits:set,smb.trans2.mid65; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42332; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.OilRig variant outbound connection attempt"; flow:to_server,established; http_uri; content:"/what?",depth 6; pcre:"/\/what\?[A-F0-9]+?$/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/en/file/231115a614c99e8ddade4cf4c88472bd3801c5c289595fc068e51b77c2c8563f/analysis/; classtype:trojan-activity; sid:45946; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.OilRig variant outbound connection attempt"; flow:to_server,established; http_uri; content:"/resp?",depth 6; pcre:"/\/resp\?[A-F0-9]+?(AAZ|ABZ)/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/en/file/231115a614c99e8ddade4cf4c88472bd3801c5c289595fc068e51b77c2c8563f/analysis/; classtype:trojan-activity; sid:45948; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Revenge RAT inbound heartbeat check"; flow:to_client,established; content:"PNC|2A 2D 5D|NK|5B 2D 2A|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/518f7803ad1b8e630f50719d7cb3638ea5d67fa4d4387a55f44ddca4ef55a3ee/analysis/; reference:url,www.virustotal.com/en/file/79bdbf9ec639d5ccf3992e9c9fe9eeba21d191dc168194a80b50f3aa8068892a/analysis/; reference:url,www.virustotal.com/en/file/edb115dd5ca7c7f9dd069746daa0a4ee6298bf94de62510d3f8bebfa5f5a8bcd/analysis/; classtype:trojan-activity; sid:45962; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Dunihi outbound connection"; flow:to_server,established; content:"|00 00 A2 30 81 9F 30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 81 8D 00 30 81 89 02 81 81 00|",depth 32; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/be442a5f8be3bf720236f71a613a534b8aa82b16b0daf8ff84a59bcb92e19e7d/analysis/; classtype:trojan-activity; sid:46827; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Malware.Innaput variant outbound connection"; flow:established,to_server,no_stream; isdataat:!60; isdataat:59; content:"|00 00 00 00|",depth 4; pcre:"/^\x00\x00\x00\x00[0-9a-f]{24}\x00/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/1570e5d88d14111fb0293fdb9764f34ff19550a1f97c9dee684607924f5a3bb4/detection; classtype:trojan-activity; sid:47030; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Mylobot inbound connection"; flow:to_client,established; content:"|08 B6 AA AA AE E4 F1 F1|",depth 8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/9f930b106c1d1ddcb832a86e14c0474d3d2e6c22b0d3408fccfa8347d7f4e7c4/analysis/; classtype:trojan-activity; sid:47243; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Malware.Ramnit outbound REGISTER_BOT beacon"; flow:to_server,established; content:"|E2 00 20 00 00 00|",depth 6; content:"|00 20 00 00 00|",within 5,distance 32; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/014d3906781472663461a9527eace4bbb69c4914964b050e119857b2f72a3799/detection; classtype:trojan-activity; sid:47244; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|1B 84 D5 B0 5D F4 C4 93|",depth 8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/1cc8f8b1487893b2b0ff118faa2333e1826ae1495b626e206ef108460d4f0fe7/analysis/; classtype:trojan-activity; sid:47299; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|24 8A 91 18 92 BB 4B 55 39 BC ED|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/88d606ce0dd8e695a0cd4221475ce904e9c460f801a4aaf696df92cdf3357c8e/analysis/; classtype:trojan-activity; sid:47301; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|57 40 CB 6D E6 5F 6D 51 4E E7 62|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/c99218e6a9577e3012522c7eac9f18197f517815f2c1ea63950c5ac205643055/analysis/; classtype:trojan-activity; sid:47302; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|EB E7 A2 EC 6E 3E CC A8 34 B5 91|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/84fd7f835de57d55ee857e7574664119ec4e8b51cf7a32c343e25d80a24fa68c/analysis/; classtype:trojan-activity; sid:47303; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|5E 0D 10 DB 92 BF 73 6C 7D 6F 5D|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/9633246f366d63cbc70eb14b3c50d58de41ffce75ba7685d82c185ecfdda5686/analysis/; classtype:trojan-activity; sid:47304; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection"; flow:to_server,established; content:"|8B 61 83 32 80 96 A0 F7 50 CD D9|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/8710e87642371c828453d59c8cc4edfe8906a5e8fdfbf2191137bf1bf22ecf81/analysis/; classtype:trojan-activity; sid:47305; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Zegost variant outbound connection"; flow:to_server,established; content:"|2A 00 00 00|",depth 4; isdataat:37,relative; isdataat:!38,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/#/file/108bbc4ff7b7da4f0de1225094964d03b19fc38b93933f739c475f08ae17915e/detection; classtype:trojan-activity; sid:47567; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Java.Trojan.Adwind variant outbound connection"; flow:to_server,established; content:"|00 00 00 04 77 2A 00 28|",depth 8; isdataat:39,relative; pcre:"/\x77\x2a\x00\x28[a-f0-9]{40}/i"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/file/0a2f74a7787ae904e5a22a3c2b3acf0316c10b95fae08cced7ca5e2fcc7d9bf8/analysis; classtype:trojan-activity; sid:47843; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.OilRig variant outbound connection"; flow:to_server,established; http_uri; content:"/tahw?",depth 6; pcre:"/\x2ftahw\x3f[A-F0-9]{3,84}$/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47898; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.OilRig variant outbound connection"; flow:to_server,established; http_uri; content:"/khc?",depth 5; pcre:"/\x2fkhc\x3f[A-F0-9]{3,84}$/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47899; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.OilRig variant outbound connection"; flow:to_server,established; http_uri; content:"/pser?",depth 6; pcre:"/\x2fpser\x3f[A-F0-9]{3,84}(BBZ|BBY)/"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/#/file/055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9; classtype:attempted-user; sid:47900; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Worm.Redhip variant outbound connection"; flow:to_server,established; http_uri; content:"/XXXX.dll",depth 9; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/en/file/15f8396754898348d0df09c85a304e2359c9102e87e7fed270e10b3814a82a7d/analysis/; classtype:trojan-activity; sid:48147; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.FormBook variant outbound request detected"; flow:to_server,established; http_uri; content:"/xyz.123",depth 8,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,blog.talosintelligence.com/2018/10/old-dog-new-tricks-analysing-new-rtf_15.html; classtype:trojan-activity; sid:48287; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.tRat variant outbound cnc connection"; flow:to_server,established; content:"CF9C77",depth 6; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/cdb8a02189a8739dbe5283f8bc4679bf28933adbe56bff6d050bad348932352b; classtype:trojan-activity; sid:48466; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.FlawedGrace outbound connection"; flow:to_server,established; content:"|06|E6|17|GCRG|01 00 00 00 02 00|",depth 14; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/d56429d6d0222022fe8f4cb35a28cd4fb83f87b666a186eb54d9785f01bb4b58; classtype:trojan-activity; sid:48882; rev:1; )
alert tcp $HOME_NET any -> $HOME_NET 443 ( msg:"MALWARE-CNC Win.Ransomware.Crytekk variant post-compromise outbound connection detected"; flow:to_server,established; content:"Encrypted",depth 9; isdataat:!10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/6029daa089fcc8b30cdf88c882fb0ef95586c2bbb1535dcb69e172e3d757cd93/detection; classtype:trojan-activity; sid:49328; rev:1; )
alert tcp $HOME_NET any -> $HOME_NET 443 ( msg:"MALWARE-CNC Win.Ransomware.Crytekk variant post-compromise outbound connection detected"; flow:to_server,established; content:"Decrypted",depth 9; isdataat:!10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/6029daa089fcc8b30cdf88c882fb0ef95586c2bbb1535dcb69e172e3d757cd93/detection; classtype:trojan-activity; sid:49329; rev:1; )
alert tcp $HOME_NET any -> $HOME_NET 443 ( msg:"MALWARE-CNC Win.Ransomware.Crytekk variant post-compromise outbound connection detected"; flow:to_server,established; content:"Already Decrypted or Deleted HT File.",depth 37; isdataat:!38; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/6029daa089fcc8b30cdf88c882fb0ef95586c2bbb1535dcb69e172e3d757cd93/detection; classtype:trojan-activity; sid:49330; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Downloader.JasperLoader outbound connection"; flow:to_server,established; http_uri; content:"/loadercrypt_",depth 13; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/0a6678204ce53902234517def01c42cd6485efafe7b4142a10287030f3f1755f/detection; classtype:trojan-activity; sid:49914; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Unix.Miner.Decred variant outbound connection"; flow:to_server,established; http_uri; content:"/ping?mac=",depth 10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/feff5ab4bb52ad6480e2d71a8094acc56cdb06e4163ecea5655a7709fddcff30; classtype:trojan-activity; sid:50281; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Unix.Miner.Decred variant outbound connection"; flow:to_server,established; http_uri; content:"/mining_url/get?algorithm=",depth 26; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/feff5ab4bb52ad6480e2d71a8094acc56cdb06e4163ecea5655a7709fddcff30; classtype:trojan-activity; sid:50282; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Unix.Miner.Decred variant outbound connection"; flow:to_server,established; http_uri; content:"/upload/machine_info?mac=",depth 25; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/feff5ab4bb52ad6480e2d71a8094acc56cdb06e4163ecea5655a7709fddcff30; classtype:trojan-activity; sid:50284; rev:2; )
alert udp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.PlugX variant outbound connection"; flow:to_server; content:"|50 00 01 00 00 00 00 04 00 00 00 10 00 00 00 00 00 00|",depth 18,offset 2; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/f13536685206a94a8d3938266f100bb2dffa740a202283c7ea35c58e6dbbb839; classtype:trojan-activity; sid:50380; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Malware.Ramnit inbound VERIFY_HOST response"; flow:to_client,established; content:"|86 00 00 00 51 00 80 00 00 00|",depth 10,offset 2; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/#/file/014d3906781472663461a9527eace4bbb69c4914964b050e119857b2f72a3799/detection; classtype:trojan-activity; sid:50440; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Unix.Trojan.HiddenWasp trojan variant outbound connection"; flow:to_server,established; content:"uces",depth 4; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/f807d3be616edb10659b4c5c0f7fb2f0d05243526c64b3323f55eb7cea8efc31/detection; classtype:trojan-activity; sid:50456; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.RoyalRoad APT campaign outbound connection"; flow:to_server,established; http_raw_uri; bufferlen:>50; http_uri; content:"/CApp.php?name=",depth 15,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,virustotal.com/gui/file/bf9987b84b3f7daaa460777e5850a60f10898d0238048d3d5d07d7ec1656e47a/detection; classtype:trojan-activity; sid:50689; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Plurox variant outbound connection"; flow:to_server,established; content:"|88 46 0A 6E|",depth 4; content:"|88 46 0A 6E 88 46 0A 6E|",within 8,distance 12; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/521694b03bd48e9eca02db31cc7565ad3863bdd07ad4c099aabce260f91cc8ad/detection; classtype:trojan-activity; sid:50717; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.Helminth outbound DNS tunnel"; flow:to_server,no_stream; content:"|01 00|",depth 2,offset 2; content:"zz000000",within 8,distance 9; content:"30",within 2,distance 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; reference:url,virustotal.com/gui/file/089bf971e8839db818ac462f53f82daed523c413bfc2e01fb76dd70b37162afe; classtype:trojan-activity; sid:50761; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.Helminth outbound DNS tunnel"; flow:to_server,no_stream; content:"|01 00|",depth 2,offset 2; content:"00000000",within 8,distance 9; content:"30",within 2,distance 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; reference:url,virustotal.com/gui/file/662c53e69b66d62a4822e666031fd441bbdfa741e20d4511c6741ec3cb02475f; classtype:trojan-activity; sid:50762; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.Helminth outbound DNS tunnel"; flow:to_server,no_stream; content:"|01 00|",depth 2,offset 2; content:"ww000000",within 8,distance 9; content:"30",within 2,distance 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; reference:url,virustotal.com/gui/file/d808f3109822c185f1d8e1bf7ef7781c219dc56f5906478651748f0ace489d34; classtype:trojan-activity; sid:50763; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.ISMAgent outbound DNS tunnel"; flow:to_server,no_stream; content:"|01 00|",depth 2,offset 2; content:"|01|n|01|n|01|c",within 6,distance 8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; reference:url,virustotal.com/gui/file/a9f1375da973b229eb649dc3c07484ae7513032b79665efe78c0e55a6e716821; classtype:trojan-activity; sid:50765; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.ALMA_Dash outbound DNS tunnel"; flow:to_server,no_stream; content:"|01 00|",depth 2,offset 2; content:"ID",within 2,distance 13; content:"-0-2d-2d",within 8,distance 9; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; reference:url,virustotal.com/gui/file/f37b1bbf5a07759f10e0298b861b354cee13f325bc76fbddfaacd1ea7505e111; classtype:trojan-activity; sid:50766; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 ( msg:"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection"; flow:to_server,established; content:"|24 00 02|",depth 3; isdataat:!36; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/8c56679d5f3c4ea676da0d8f2b1f77f59102700f0641b30f210183ded0dcabe8/detection; classtype:trojan-activity; sid:50808; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 ( msg:"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection"; flow:to_server,established; content:"|0B 00 03|",depth 3; isdataat:!12; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/8c56679d5f3c4ea676da0d8f2b1f77f59102700f0641b30f210183ded0dcabe8/detection; classtype:trojan-activity; sid:50809; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 ( msg:"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection"; flow:to_server,established; content:"|02 00 04|",depth 3; isdataat:!8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/bd8b1bd06817772af89d93a1789d5df13e15136e53a6af60be0900986c56234f/detection; classtype:trojan-activity; sid:50810; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 ( msg:"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection"; flow:to_server,established; content:"|01 00 10|",depth 3; content:"|00 12 5C|",within 3,distance 9; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,virustotal.com/gui/file/bd8b1bd06817772af89d93a1789d5df13e15136e53a6af60be0900986c56234f/detection; classtype:trojan-activity; sid:50811; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Malware.Lookback outbound connection to a known URI path"; flow:established,to_server; http_uri; content:"/status.gif?r=1",depth 15; http_raw_uri; content:"http",depth 4; http_method; content:"POST",depth 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/a2d41af0b4f8f0fd950fd4ac164cb2c836fd3c679688b4db75e85ffabfc20d94/detection; classtype:trojan-activity; sid:50934; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Malware.Lookback outbound connection"; flow:established,to_server; http_client_body; content:"|C2 2E AB 48 C0 01 00 00|",depth 8; isdataat:!456,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/#/file/a2d41af0b4f8f0fd950fd4ac164cb2c836fd3c679688b4db75e85ffabfc20d94/detection; classtype:trojan-activity; sid:50935; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Agent variant outbound connection "; flow:to_server,established; content:"|04 6A 04 00 00 00 00 00 00|",depth 9; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/#/file/738ba44188a93de6b5ca7e0bf0a77f66f677a0dda2b2e9ef4b91b1c8257da790/analysis; classtype:attempted-user; sid:52148; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; isdataat:!12; content:"|7C 30 7C A1 40 23 40 21|",depth 8,offset 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52548; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; isdataat:!11; content:"|7C|root|7C|",depth 6,offset 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52549; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Remcos variant outbound connection detected"; flow:to_server,established; content:"|EA E9 4B 45 E4 21 FB CF 1E 89 6C|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/en/file/ee0f3eb8a4d7c87a4c33a1f8b08e78bb95fa7ee41ddf0b07d9b6eabe87a33b2e; classtype:trojan-activity; sid:52614; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Agent variant outbound connection"; flow:to_server,established; http_uri; content:"/open?topics=",depth 13; pcre:"/\/open\?topics=s9[0-9]{3}/i"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,blogs.jpcert.or.jp/en/2019/07/spear-phishing-against-cryptocurrency-businesses.html; classtype:trojan-activity; sid:52623; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 3344 ( msg:"MALWARE-CNC Win.Trojan.ObliqueRAT outbound connection"; flow:to_server,established; content:"nak|00|",depth 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/37c7500ed49671fe78bd88afa583bfb59f33d3ee135a577908d633b4e9aa4035; classtype:trojan-activity; sid:53155; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 3344 ( msg:"MALWARE-CNC Win.Trojan.ObliqueRAT outbound connection"; flow:to_server,established; content:"ack|00|",depth 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/37c7500ed49671fe78bd88afa583bfb59f33d3ee135a577908d633b4e9aa4035; classtype:trojan-activity; sid:53154; rev:1; )
alert tcp $EXTERNAL_NET [5156,7218,9686,12538,16468] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.CrimsonRAT inbound command"; flow:to_client,established; content:"|00|thnaviwa-",depth 10,offset 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/98894973a86aa01c4f7496ae339dc73b5e6da2f1dbcd5fe1215f70ea7b889b85; classtype:trojan-activity; sid:53153; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [5156,7218,9686,12538,16468] ( msg:"MALWARE-CNC Win.Trojan.CrimsonRAT outbound connection"; flow:to_server,established; content:"|00|thnaviwa-",depth 10,offset 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/gui/file/98894973a86aa01c4f7496ae339dc73b5e6da2f1dbcd5fe1215f70ea7b889b85; classtype:trojan-activity; sid:53152; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Parallax variant outbound cnc connection attempt"; flow:to_server,established; content:"|5E C5 D1 DD 79 2F F2|",depth 7; content:"|34 2D|",within 2,distance 15; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/sha256/a984da90a5ad37b1ce550f33ff607095db19355c04025e38b3ee45ac8f693eb5; classtype:trojan-activity; sid:53437; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Parallax variant outbound cnc connection attempt"; flow:to_server,established; content:"|5E 52 4A 3B A4 11 7F|",depth 7; content:"|A7 30|",within 2,distance 15; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/sha256/02fcecc7722b4c3ed5e09f31f445b721dac16545db65c8be201aa4c0b8cfcb4b; classtype:trojan-activity; sid:53439; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 7279 ( msg:"MALWARE-CNC Win.Malware.Remcos variant outbound cnc connection"; flow:to_server,established; content:"|77 E4 53 6A D9 F6 8B 9A D4 5E 0F|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/73734608e9413c807c8f09f793b55b77425b328052b5fa4ff82d66d6d4c15a34/detection; classtype:trojan-activity; sid:53792; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,53,443,8080] ( msg:"MALWARE-CNC Win.Malware.Agent variant outbound cnc connection"; flow:to_server,established,only_stream; content:"|00 00 00 00 15 00 00 00 00 00 00 00|",depth 12,offset 9; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/d6841b2a82904efc52c6b0b9375ddd3aa70de360c9f605341631358331a66ba0/detection; classtype:trojan-activity; sid:53957; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Malware.Agent variant outbound cnc connection attempt"; flow:to_server,established; content:"PK|03 04 14 00 09 00|",depth 8,offset 21; content:"|01 00|",within 2,distance 18; byte_jump:4,-36,relative,little,from_beginning,post_offset -1; isdataat:0,relative; isdataat:!1,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/6a8f59ad46ad22f272d5617e8d8101af820772abd5b162e3e9a9cc5dfb2f46ac/detection; classtype:trojan-activity; sid:53958; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.WINNTI variant outbound connection"; flow:to_server,established; content:"|B7 E8 F7 F7 00 00 00 00 7F 7F 7F 7F 80 80 80 80|",depth 16; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/gui/file/dbd03093e58c2d60f4f47b720691cd3e6310f0566403ee0a34c2d59db9fc58d2/detection; classtype:trojan-activity; sid:53994; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.WINNTI variant outbound connection"; flow:to_server,established; content:"|01 00 00|B5165|B8 01 00 00|",depth 12,offset 1; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/gui/file/dbd03093e58c2d60f4f47b720691cd3e6310f0566403ee0a34c2d59db9fc58d2/detection; classtype:trojan-activity; sid:53995; rev:1; )
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-CNC Win.Malware.Hancitor variant inbound connection"; flow:to_client,established; file_data; content:"|80 A8 15 54 BA 4F 6D 9F 11 10 15 19 E0 DF 6D 9C 80 A8 15 D6 BE 4F 5D 60 7F A8 15 EC BA 77 40 9E|",depth 32; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,www.virustotal.com/gui/file/0e03a0e73670a94c5c1efcbf7512b0eca8ca899e58ed6dca2b12c8fcb31ccfb4/detection; classtype:trojan-activity; sid:53998; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Malware.Qealler variant outbound connection"; flow:established,to_server; content:"|53 E1 6D D3 9E EE 45 D4|",depth 8; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,virustotal.com/#/file/366336db4ff21cb50e95574aa7ced320b9c35f528397df31609478caefdd937f/detection; classtype:trojan-activity; sid:54046; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Taidoor variant outbound connection"; flow:to_server,established; isdataat:262; isdataat:!263; content:"F::",depth 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.virustotal.com/gui/file/4a0688baf9661d3737ee82f8992a0a665732c91704f28688f643115648c107d4/detection; reference:url,www.virustotal.com/gui/file/6e6d3a831c03b09d9e4a54859329fbfd428083f8f5bc5f27abbfdd9c47ec0e57/detection; classtype:trojan-activity; sid:54801; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!8; content:"|19 1A 18 10 1E 1F|",depth 6; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57168; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!5; content:"|09 15 16|",depth 3; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57169; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!6; content:"|10 12 17 17|",depth 4; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57170; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!6; content:"|1A 0E 0F 14|",depth 4; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57171; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!5; content:"|09 13 0F|",depth 3; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57172; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!5; content:"|0F 08 10|",depth 3; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57173; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_client,no_stream; isdataat:!9; content:"|09 1E 08 0F 1A 09 0F|",depth 7; flowbits:set,fb_obliquerat; flowbits:noalert; metadata:impact_flag red,policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57174; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.ObliqueRAT outbound connection attempt"; flow:established,to_server,no_stream; isdataat:!5; flowbits:isset,fb_obliquerat; content:"|1A 18 10 7B|",depth 4; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,blog.talosintelligence.com/2020/02/obliquerat-hits-victims-via-maldocs.html; classtype:trojan-activity; sid:57175; rev:1; )
alert udp $HOME_NET any -> $HOME_NET 137 ( msg:"MALWARE-OTHER Dorifel/Quervar/XDocCrypt query for machine name KASPERSKY"; content:"|01 10 00 01|",depth 4,offset 2; content:" ELEBFDFAEFFCFDELFJCACACACACACAAA|00 00 20 00 01|",depth 38,offset 12; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ns; reference:url,blog.eset.com/2012/08/21/quervar-induc-c-reincarnate; reference:url,hitmanpro.wordpress.com/2012/08/11/joint-strike-force-against-dorifel/; classtype:trojan-activity; sid:24143; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-OTHER Keylogger WL-Keylogger inbound connection"; flow:to_client,established; content:"ServerDetails",depth 13,nocase; flowbits:set,Malware_Keylogger_InitConnection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.megasecurity.org/trojans/k/keylogger/Keylogger_darkdays.html; classtype:trojan-activity; sid:19324; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:"MALWARE-OTHER Keylogger remotekeylog.b runtime detection - fun"; flow:to_server,established; content:"fun",depth 3; flowbits:set,RemoteKeyLog.b.Fun_detection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:12135; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:"MALWARE-OTHER Keylogger remotekeylog.b runtime detection - open url"; flow:to_server,established; content:"url",depth 3; flowbits:set,RemoteKeyLog.b.Url_detection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:12133; rev:6; )
alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:"MALWARE-OTHER Keylogger remotekeylog.b runtime detection - keylogging"; flow:to_client,established; content:"WND",depth 3; flowbits:set,RemoteKeyLog.b.Keylogging_detection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:12131; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:"MALWARE-OTHER Keylogger remotekeylog.b runtime detection - get sys info"; flow:to_server,established; content:"info",depth 4; flowbits:set,RemoteKeyLog.b.Info_detection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:12129; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:"MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection"; flow:to_server,established; content:"url",depth 3,nocase; flowbits:set,Win32.RemoteKeylog.b.website; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:10099; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:"MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection"; flow:to_server,established; content:"info",depth 4,nocase; flowbits:set,Win32.RemoteKeylog.b.info; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1056; classtype:successful-recon-limited; sid:10097; rev:7; )
alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:"MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 4"; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve3; content:"chkCap",depth 6; flowbits:set,ABSystemSpy_Inforetrieve4; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7168; rev:7; )
alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:"MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 3"; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve2; content:"chkCli",depth 6; flowbits:set,ABSystemSpy_Inforetrieve3; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7167; rev:8; )
alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:"MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 2"; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve1; content:"chkShe",depth 6; flowbits:set,ABSystemSpy_Inforetrieve2; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7166; rev:8; )
alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:"MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 1"; flow:established; content:"chkLis",depth 6; flowbits:set,ABSystemSpy_Inforetrieve1; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.spywareguide.com/product_show.php?id=591; classtype:successful-recon-limited; sid:7165; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 10050 ( msg:"MALWARE-OTHER Keylogger win-spy runtime detection - remote conn client-to-server"; flow:to_server,established; content:"/CLUserName|18|Password|16|",depth 21,nocase; flowbits:set,winspy_conn_client-to-server; flowbits:noalert; reference:url,attack.mitre.org/techniques/T1056; reference:url,securityresponse.symantec.com/avcenter/venc/data/spyware.winspy.html; reference:url,www.spywareguide.com/product_show.php?id=715; classtype:successful-recon-limited; sid:7157; rev:5; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-OTHER Win.Ransomware.Samsam propagation via SMB2 transfer attempt"; flow:to_server,established; content:"|FE|SMB",depth 4,offset 4; content:"|05 00|",within 2,distance 8; byte_jump:4,98,relative,little,from_beginning; content:".|00|s|00|t|00|u|00|b|00|b|00|i|00|n|00|",within 16,distance -18; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:url,www.virustotal.com/en/file/8eabfa74d88e439cfca9ccabd0ee34422892d8e58331a63bea94a7c4140cf7ab/analysis/; classtype:trojan-activity; sid:45485; rev:2; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-OTHER SamSam associated file"; flow:to_server,established; content:"|FE|SMB",depth 4,offset 4; content:"|05 00|",within 2,distance 8; byte_jump:4,98,relative,little,from_beginning; content:".|00|n|00|i|00|k|00|e|00|2|00|0|00|1|00|8",within 17,distance -18; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:url,www.us-cert.gov/ncas/analysis-reports/AR18-337A; classtype:trojan-activity; sid:48811; rev:1; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"MALWARE-OTHER Win.Dropper.Agent payload download attempt"; flow:to_client,established; file_data; content:"|50 4B 03 04|",depth 4; content:"|07 00 00 00|wsc.dll",within 11,distance 22; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:url,www.virustotal.com/gui/file/d6841b2a82904efc52c6b0b9375ddd3aa70de360c9f605341631358331a66ba0/detection; classtype:trojan-activity; sid:53952; rev:1; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"MALWARE-OTHER Win.Dropper.Agent payload download attempt"; flow:to_server,established; file_data; content:"|50 4B 03 04|",depth 4; content:"|07 00 00 00|wsc.dll",within 11,distance 22; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:url,www.virustotal.com/gui/file/d6841b2a82904efc52c6b0b9375ddd3aa70de360c9f605341631358331a66ba0/detection; classtype:trojan-activity; sid:53954; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4563 ( msg:"MALWARE-TOOLS Hacker-Tool clandestine runtime detection - flowbit set open"; flow:to_server,established; content:"open",depth 4,nocase; flowbits:set,Clandestine_CTS1; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=1295; classtype:misc-activity; sid:7584; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4563 ( msg:"MALWARE-TOOLS Hacker-Tool clandestine runtime detection - flowbit set big"; flow:to_server,established; content:"big",depth 3,nocase; flowbits:set,Clandestine_CTS1; flowbits:noalert; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=1295; classtype:misc-activity; sid:7583; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 10607 ( msg:"MALWARE-TOOLS Hacker-Tool coma runtime detection - init connection - flowbit set"; flow:to_server,established; content:"Hello",depth 5; flowbits:set,coma.1; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:7506; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 QUERY_FILE_INFO attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3135; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 QUERY_FILE_INFO andx attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2",depth 1,offset 39; byte_jump:2,0,little,relative; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3136; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3137; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3139; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 andx attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2",depth 1,offset 39; byte_jump:2,0,little,relative; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3140; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 FIND_FIRST2 attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3141; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 FIND_FIRST2 andx attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2",depth 1,offset 39; byte_jump:2,0,little,relative; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3142; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 ( msg:"NETBIOS SMB session negotiation request"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMBr",within 5,distance 3; flowbits:set,smb.session.negotiate; flowbits:noalert; metadata:policy max-detect-ips alert; service:netbios-ssn; classtype:misc-activity; sid:16381; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 ( msg:"NETBIOS SMB TRANS2 Find_First2 request attempt"; flow:to_server,established; content:"|FF|SMB2|00 00 00 00|",depth 9,offset 4; content:"|00 00|",within 2,distance 13; content:"|00|",within 1,distance 18; content:"|00 00|",within 2,distance 6; content:"|01 00|",within 2,distance 10; flowbits:set,smb.trans2.findfirst2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:17745; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO andx attempt"; flow:established,to_server; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; content:"2",depth 1,offset 39; byte_jump:2,0,little,relative; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3138; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] ( msg:"NETBIOS DCERPC NCACN-IP-TCP NetShareEnumAll request"; flow:established,to_server; dce_iface:uuid 4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:"15"; content:"|00|",depth 1; content:"|FF|SMB|25|",within 5,distance 3; content:"|00 00 00 00|",within 4; byte_test:1,!&,128,0,relative,dce; flowbits:set,dce.net_share_enum_all.request; flowbits:noalert; metadata:policy max-detect-ips alert; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1049; classtype:protocol-command-decode; sid:20274; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS SMB negotiate protocol request - ascii strings"; flow:to_server,established; content:"|FF|SMB|72 00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x40,0,relative,little; byte_test:2,!&,0x8000,1,relative,little; flowbits:set,smb.req.ascii; flowbits:noalert; metadata:policy max-detect-ips alert; service:netbios-ssn; classtype:protocol-command-decode; sid:17151; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 find file and directory info request"; flow:to_server,established; content:"|FF|SMB2|00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x80,0,relative; content:"|01 00|",within 2,distance 52; byte_jump:2,-10,relative,little,from_beginning,post_offset 10; content:"|04 01|",within 2; flowbits:set,smb.trans2.fileinfo; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:24972; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP srvsvc NetrpPathCanonicalize path canonicalization stack overflow attempt"; flow:to_server,established; dce_iface:uuid 4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:"31 32"; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{4}(\x00\x00\x00\x00|.{12}))/s"; byte_jump:4,-4,multiplier 2,relative,align,dce; pcre:"/\x00\.\x00\.\x00[\x2f\x5c]/R"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2008-4250; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-067; classtype:attempted-admin; sid:14782; rev:21; )
alert udp $EXTERNAL_NET 4433 -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows DTLSv1.0 handshake cookie buffer overflow attempt"; flow:to_client; content:"|16 FE FF|",depth 3; content:"|03|",within 1,distance 10; content:"|FE FF|",within 2,distance 11; byte_test:1,>,32,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2014-6321; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-066; classtype:attempted-admin; sid:32422; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB COPY command oversized pathname attempt"; flow:to_server,established; content:"|FF|SMB|29|",depth 5,offset 4; byte_jump:1,27,relative,multiplier 2; byte_test:2,>,2300,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2010-0020; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-012; classtype:attempted-admin; sid:16395; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS Microsoft Windows LSARPC LsapLookupSids denial of service attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ab; dce_opnum:"15"; dce_stub_data; content:"|00 00 00 00|",depth 4,offset 20; content:"|00 00 00 00|",within 4,distance 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2016-0135; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-046; classtype:attempted-dos; sid:38458; rev:2; )
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows GDI WMF out of bounds read attempt"; flow:to_client,established; file_data; content:"|D7 CD C6 9A 00 00|",depth 6; byte_test:2,>,0x8000,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data, http, imap, pop3; reference:cve,2017-0073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms17-013; classtype:attempted-user; sid:41993; rev:2; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"OS-WINDOWS Microsoft Windows GDI WMF out of bounds read attempt"; flow:to_server,established; file_data; content:"|D7 CD C6 9A 00 00|",depth 6; byte_test:2,>,0x8000,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:cve,2017-0073; reference:url,technet.microsoft.com/en-us/security/bulletin/ms17-013; classtype:attempted-user; sid:41994; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows Search Service out of bounds memory access attempt"; flow:to_server,established; content:"|FE|SMB|40 00|",depth 6,offset 4; content:"|0B 00|",within 2,distance 6; content:"|D0 00 00 00 00 00 00 00|",within 8,distance 106; content:"|00 00 00 00|",within 4,distance 4; byte_test:4,>,0x700,4,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2017-8543; classtype:attempted-admin; sid:43175; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows Search Service out of bounds memory access attempt"; flow:to_server,established; content:"|FE|SMB|40 00|",depth 6,offset 4; content:"|0B 00|",within 2,distance 6; content:"|CC 00 00 00 00 00 00 00|",within 8,distance 106; content:"|00 00 00 00|",within 4,distance 4; byte_test:4,>,0x700,16,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2017-8543; classtype:attempted-admin; sid:43176; rev:2; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows raw WriteAndX InData pointer adjustment attempt"; flow:to_server,established; content:"|FF|SMB|2F 00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x80,0,relative; byte_test:2,&,0x4,38,relative,little; byte_test:2,>=,512,44,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:attempted-admin; sid:50626; rev:1; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft SMB Trans secondary out of bounds write attempt"; flow:to_server,established; content:"|FF|SMB|26 00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x80,0,relative; byte_test:2,>,0x28a0,38,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:attempted-admin; sid:50627; rev:1; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_server,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:2,>,0x0001,6,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53425; rev:3; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_server,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:4,>,0x3fffffff,0,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53426; rev:3; )
alert tcp any 445 -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_client,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:4,>,0x3fffffff,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53427; rev:3; )
alert tcp any 445 -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_client,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:2,>,0x0001,6,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53428; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 3391 ( msg:"OS-WINDOWS Windows RDP Gateway Server denial of service attempt"; content:"|05 00|",depth 2; byte_test:2,>,10000,0,relative; detection_filter:track by_src, count 4, seconds 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2020-0609; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0609; classtype:attempted-dos; sid:53436; rev:1; )
alert tcp any 445 -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_client,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:4,>,0x3fffffff,8,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53447; rev:1; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys remote code execution attempt"; flow:to_server,established; content:"|FC|SMB",depth 4,offset 4; byte_test:2,<=,0x0003,4,relative,little; byte_test:4,>,0x3fffffff,8,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-0796; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-0796; classtype:attempted-admin; sid:53448; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB srv2.sys information disclosure attempt"; flow:to_server,established; content:"|FC|SMB|70 10 00 00 02 00 00 00 00 00 00 00 18 08 46 02 FE|SMB|40 00 03 00 09 00 4D 00 00 00 05 18 00 01 00 FF FE 00 00 01 38 00 29 00|",depth 48,offset 4; isdataat:83; isdataat:!84; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-1206; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-1206; classtype:attempted-recon; sid:54217; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMBv1 remote code execution attempt"; flow:to_server,established; content:"|FF|SMB|A0 00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x80,0,relative; content:"|02 00 00 01 09 00|",within 6,distance 60; content:"|01 00 00 00|",within 4,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2020-1301; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-1301; classtype:attempted-admin; sid:54240; rev:1; )
alert tcp any any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows Netlogon crafted NetrServerReqChallenge elevation of privilege attempt"; flow:to_server,established; dce_iface:uuid 12345678-1234-abcd-ef00-01234567cffb; dce_opnum:"4"; content:"|04 00|",depth 2,offset 22; detection_filter:track by_src, count 15, seconds 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2020-1472; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472; classtype:attempted-admin; sid:55703; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 2049 ( msg:"OS-WINDOWS Microsoft Windows NFS read procedure remote code execution attempt"; flow:to_server; content:"|00 00 00 00|",depth 4,offset 4; content:"|00 01 86 A3|",within 4,distance 4; content:"|00 00 00 06 00 00 00 01|",within 8,distance 4; byte_jump:4,0,relative; content:"|00 00 00 01|",within 4; byte_test:4,>,104,8,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2020-17056; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-17056; classtype:attempted-admin; sid:56301; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2049 ( msg:"OS-WINDOWS Microsoft Windows NFS read procedure remote code execution attempt"; flow:to_server,established; content:"|00 00 00 00|",depth 4,offset 4; content:"|00 01 86 A3|",within 4,distance 4; content:"|00 00 00 06 00 00 00 01|",within 8,distance 4; byte_jump:4,0,relative; content:"|00 00 00 01|",within 4; byte_test:4,>,104,8,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2020-17056; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-17056; classtype:attempted-user; sid:56302; rev:1; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Microsoft Windows IPv6 stack remote execution attempt"; itype:134; icode:0; content:"|19|",depth 1,offset 12; byte_test:1,!&,1,0,relative, bitmask 0x01; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2020-16898; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16898; classtype:attempted-user; sid:55984; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1883 ( msg:"PROTOCOL-OTHER MQTT Connect control packet detected"; flow:to_server,established; content:"|10|",depth 1; content:"|00 04|MQTT|04|",within 7,distance 1; flowbits:set,MQTT_Connect; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; reference:url,docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718009; classtype:misc-activity; sid:53213; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC Windows Network File System RPCSEC_GSS_INIT message attempt"; flow:to_server,established; content:"|00 00 00 00|",depth 4,offset 8; content:"|00 00 00 06|",within 4,distance 16,fast_pattern; content:"|00 00 00 01|",within 4,distance 8; flowbits:set,rpcsecinit; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; service:sunrpc; classtype:misc-activity; sid:56310; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] ( msg:"PROTOCOL-SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|10 60 00 00 66 66 07 00 10 00 00 00 19 00 00 00|",depth 16; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:26392; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] ( msg:"PROTOCOL-SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|",depth 4,offset 4; byte_jump:4,0,relative,little,post_offset -4; byte_test:4,>,0x800,0,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25852; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] ( msg:"PROTOCOL-SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; content:"|00 00 00 00|",depth 4,offset 4; byte_jump:4,0,relative,little,post_offset -4; byte_test:4,<,0x20,0,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25851; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 ( msg:"PROTOCOL-SCADA KingSCADA Alarm Server stack buffer overflow attempt"; flow:to_server,established; content:"|D2 04 00 00 7B 00 00 00|",depth 8; byte_test:4,>,0x7EF,0,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,66709; reference:cve,2014-0787; classtype:attempted-admin; sid:32059; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 260 ( msg:"PROTOCOL-SCADA TraceMode Runtime DOS attempt"; flow:to_server; isdataat:1000; content:"|0C 0C 0C 0C 0C 0C 0C 0C|",depth 8; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.adastra.ru/products/dev/scada/; classtype:attempted-dos; sid:42074; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 260 ( msg:"PROTOCOL-SCADA TraceMode Runtime DOS attempt"; flow:to_server; isdataat:1000; content:"|17 17 17 17 17 17 17 17|",depth 8; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,www.adastra.ru/products/dev/scada/; classtype:attempted-dos; sid:42075; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-ADWARE Classroom Spy Professional outbound connection - initial connection"; flow:to_client,established; content:"|00 00 00 34|",depth 4; flowbits:set,Malware_ClassroomSpyPro_detection3; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,ca.com/us/securityadvisor/pest/pest.aspx?id=453101935; classtype:trojan-activity; sid:19326; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-ADWARE Snoopware remote desktop inspector outbound connection - init connection"; flow:to_server,established; content:"DS|00 00 00 00 01 00 00 00 00 FE 01 00 00 F1 00 00 00 00|",depth 20,nocase; flowbits:set,RemoteDesktopInspector_detection; flowbits:noalert; metadata:policy max-detect-ips alert; reference:url,attack.mitre.org/techniques/T1076; classtype:successful-recon-limited; sid:13346; rev:6; )
alert udp $EXTERNAL_NET any -> $HOME_NET 5004:65535 ( msg:"PUA-OTHER Microsoft MSN Messenger and Windows Live Messenger Code Execution attempt"; flow:to_server; content:"|0E 58|",depth 2; content:"connected",within 9,distance 7; flowbits:set,messenger; flowbits:noalert; metadata:policy max-detect-ips alert; reference:bugtraq,25461; reference:cve,2007-2931; classtype:attempted-user; sid:20554; rev:10; )
alert tcp $EXTERNAL_NET 16800:17000 -> $HOME_NET any ( msg:"PUA-P2P P2PTv TVAnts TCP connection traffic detected"; flow:to_client,established; content:"|04 00|",depth 2; pcre:"/[\x01\x02\x03\x04\x05\x06\x07]\x00.{4}\x43\x00/R"; flowbits:set,tvant.session; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:12211; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 16800:17000 ( msg:"PUA-P2P P2PTv TVAnts TCP tracker connect traffic detected"; flow:to_server,established; content:"|04 00 07 00|",depth 4; content:"TVANTS SHARE",depth 12,offset 8; flowbits:set,tvant.session; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:12210; rev:5; )
alert udp $HOME_NET 16800:17000 -> $EXTERNAL_NET any ( msg:"PUA-P2P P2PTv TVAnt udp traffic detected"; content:"|04 00|",depth 2; pcre:"/[\x05\x06\x07]\x00.{6}[SD]S/R"; flowbits:set,tvant.session; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:12209; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P Skype client login startup"; flow:to_server,established; isdataat:4; isdataat:!5; content:"|16 03 01 00|",depth 4; flowbits:set,skype.login; classtype:policy-violation; sid:5998; rev:8; )
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:"SERVER-MAIL IBM Domino BMP color palette stack buffer overflow attempt"; flow:to_server,established; file_data; content:"BM",depth 2; content:"|00 00 00 00|",within 4,distance 4; content:"|28 00 00 00|",within 4,distance 4; byte_test:2,<,16,10,relative,little; byte_test:4,>,0x100,28,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; reference:bugtraq,74598; reference:cve,2015-1903; classtype:attempted-admin; sid:35944; rev:3; )
alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any ( msg:"SERVER-MYSQL server greeting"; flow:to_client,established; content:"|00|",depth 1,offset 3; flowbits:set,mysql.server_greeting; flowbits:noalert; metadata:policy max-detect-ips alert; service:mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3665; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1500 ( msg:"SERVER-OTHER IBM Tivoli Storage Manager Express Backup initialization packet"; flow:to_server,established; content:"|00 04 1D A5|",depth 4; flowbits:set,tivoli.backup; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:protocol-command-decode; sid:20874; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13701 ( msg:"SERVER-OTHER Veritas NetBackup Volume Manager connection attempt"; flow:to_server,established; byte_test:1,>,3,10,dec,string; byte_test:1,<,11,10,dec,string; flowbits:set,veritas.vmd.connect; flowbits:noalert; classtype:protocol-command-decode; sid:6404; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 515 ( msg:"SERVER-OTHER lpd receive printer job cascade adaptor protocol request"; flow:to_server,established; content:"|02|",depth 1; pcre:"/\x02[^\x0a]+\x3a[^\x0a]+\x0a/"; flowbits:set,lp.cascade; flowbits:noalert; metadata:policy max-detect-ips alert; service:ldp; classtype:protocol-command-decode; sid:4143; rev:12; )
alert tcp $HOME_NET [5800,5900:5999] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER RealVNC authentication types without None type sent attempt"; flow:to_client,established; flowbits:isset,vnc.handshake.client; flowbits:unset,vnc.handshake.client; pcre:"/^[^\x00][^\x00\x01]+$/"; flowbits:set,vnc.server.auth.types; flowbits:noalert; metadata:policy max-detect-ips alert; service:vnc-server; classtype:protocol-command-decode; sid:6470; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [5800,5900:5999] ( msg:"SERVER-OTHER RealVNC connection attempt"; flow:to_server,established; isdataat:11; isdataat:!12; content:"RFB 003.00",depth 10; content:!"3",within 1; flowbits:set,vnc.handshake.client; flowbits:set,vnc.traffic; flowbits:noalert; metadata:policy max-detect-ips alert; service:vnc-server; classtype:protocol-command-decode; sid:6469; rev:14; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [5800,5900:5999] ( msg:"SERVER-OTHER VNC client authentication response"; flow:to_server,established; content:"RFB 0",depth 5; content:".0",depth 2,offset 7; flowbits:set,vnc.auth; flowbits:noalert; metadata:policy max-detect-ips alert; service:vnc-server; classtype:protocol-command-decode; sid:17396; rev:15; )
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER SSL TLS DEFLATE compression detected"; flow:to_client,established; ssl_state:server_hello; ssl_version:tls1.0,tls1.1; content:"|16 03|",depth 2; byte_test:1,&,1,78; flowbits:set,tls.deflate; flowbits:noalert; metadata:policy max-detect-ips alert; service:ssl; classtype:misc-activity; sid:26644; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [19985,19988] ( msg:"SERVER-OTHER HP AIO Archive Query Server stack buffer overflow attempt"; flow:to_server,established; content:"GIOP|01 01|",depth 6,fast_pattern; content:"|00|",within 1,distance 1; content:"|00 00 00|",within 3,distance 13; byte_jump:4,0,relative; byte_jump:4,2,relative; byte_jump:4,0,relative; content:"|0D 06|",within 2,distance 6; byte_test:1,>,0x11,0,relative; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,64557; reference:cve,2013-6189; classtype:attempted-admin; sid:30205; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [19985,19988] ( msg:"SERVER-OTHER HP AIO Archive Query Server stack buffer overflow attempt"; flow:to_server,established; content:"GIOP|01 01|",depth 6,fast_pattern; content:"|00|",within 1,distance 1; content:"|00 00 00|",within 3,distance 13; byte_jump:4,0,relative; byte_jump:4,2,relative; byte_jump:4,0,relative; content:"|0D|",within 1,distance 6; byte_test:1,<,2,0,relative; byte_test:1,>,0x11,1,relative; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,64557; reference:cve,2013-6189; classtype:attempted-admin; sid:30206; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [19985,19988] ( msg:"SERVER-OTHER HP AIO Archive Query Server stack buffer overflow attempt"; flow:to_server,established; content:"GIOP|01 01|",depth 6,fast_pattern; content:"|00|",within 1,distance 1; content:"|00 00 00|",within 3,distance 13; byte_jump:4,0,relative; byte_jump:4,2,relative; byte_jump:4,0,relative; content:"|0D|",within 1,distance 6; byte_test:1,>,9,0,relative; byte_test:1,>,0x11,1,relative; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,64557; reference:cve,2013-6189; classtype:attempted-admin; sid:30207; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 00|",depth 3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30510; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 01|",depth 3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30511; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 02|",depth 3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30512; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 03|",depth 3; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30513; rev:8; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 00|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30514; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 01|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30515; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 02|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30516; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 03|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30517; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 00|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30520; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 01|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30521; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 02|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30522; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 03|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst, count 2, seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30523; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established; isdataat:68; isdataat:!69; content:"|18 03 03 00 40|",depth 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30525; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 11; content:"|18 03 00|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30711; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 39; content:"|18 03 00|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30712; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 11; content:"|18 03 01|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30713; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 39; content:"|18 03 01|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30714; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 11; content:"|18 03 02|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30715; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 39; content:"|18 03 02|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30716; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 11; content:"|18 03 03|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30717; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|00|",depth 1,offset 39; content:"|18 03 03|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30718; rev:5; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 11; content:"|18 03 00|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30719; rev:3; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 39; content:"|18 03 00|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30720; rev:4; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 11; content:"|18 03 01|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30721; rev:3; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 39; content:"|18 03 01|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30722; rev:4; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 11; content:"|18 03 02|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30723; rev:3; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 39; content:"|18 03 02|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30724; rev:4; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 11; content:"|18 03 03|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30725; rev:3; )
alert tcp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; byte_test:1,>=,0x20,2; byte_test:1,<=,0x27,2; content:"|01|",depth 1,offset 39; content:"|18 03 03|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30726; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 37; content:"|18 03 00|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30727; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 9; content:"|18 03 00|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30728; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 37; content:"|18 03 01|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30729; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 9; content:"|18 03 01|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30730; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 37; content:"|18 03 02|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30731; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 9; content:"|18 03 02|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30732; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 37; content:"|18 03 03|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30733; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1194 ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|00|",depth 1,offset 9; content:"|18 03 03|",within 3,distance 4; detection_filter:track by_src, count 3, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30734; rev:4; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 37; content:"|18 03 00|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30735; rev:3; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 9; content:"|18 03 00|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30736; rev:2; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 37; content:"|18 03 01|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30737; rev:3; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 9; content:"|18 03 01|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30738; rev:2; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 37; content:"|18 03 02|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30739; rev:3; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 9; content:"|18 03 02|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30740; rev:2; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 37; content:"|18 03 03|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30741; rev:3; )
alert udp $HOME_NET 1194 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenVPN OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client; byte_test:1,>=,0x20,0; byte_test:1,<=,0x27,0; content:"|01|",depth 1,offset 9; content:"|18 03 03|",within 3,distance 16; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:openvpn; reference:cve,2014-0160; classtype:attempted-recon; sid:30742; rev:2; )
alert tcp any any -> $HTTP_SERVERS 443 ( msg:"SERVER-OTHER OpenSSL SSL ChangeCipherSpec man-in-the-middle exploitation attempt"; flow:to_server,established; content:"|16 03 00|",depth 3; content:"|01|",within 1,distance 2; content:"|03 00|",within 2,distance 3; byte_test:2,!=,0,33,relative; flowbits:set,ssl_handshake; flowbits:noalert; metadata:policy max-detect-ips alert; service:ssl; reference:bugtraq,67899; reference:cve,2014-0224; reference:url,www.openssl.org/news/secadv_20140605.txt; classtype:attempted-dos; sid:31481; rev:3; )
alert tcp any any -> $HTTP_SERVERS 443 ( msg:"SERVER-OTHER OpenSSL TLSv1.0 ChangeCipherSpec man-in-the-middle exploitation attempt"; flow:to_server,established; content:"|16 03 01|",depth 3; content:"|01|",within 1,distance 2; content:"|03 01|",within 2,distance 3; byte_test:2,!=,0,33,relative; flowbits:set,tlsv1.0_handshake; flowbits:noalert; metadata:policy max-detect-ips alert; service:ssl; reference:bugtraq,67899; reference:cve,2014-0224; reference:url,www.openssl.org/news/secadv_20140605.txt; classtype:attempted-dos; sid:31482; rev:3; )
alert tcp any any -> $HTTP_SERVERS 443 ( msg:"SERVER-OTHER OpenSSL TLSv1.1 ChangeCipherSpec man-in-the-middle exploitation attempt"; flow:to_server,established; content:"|16 03 01|",depth 3; content:"|01|",within 1,distance 2; content:"|03 02|",within 2,distance 3; byte_test:2,!=,0,33,relative; flowbits:set,tlsv1.1_handshake; flowbits:noalert; metadata:policy max-detect-ips alert; service:ssl; reference:bugtraq,67899; reference:cve,2014-0224; reference:url,www.openssl.org/news/secadv_20140605.txt; classtype:attempted-dos; sid:31483; rev:3; )
alert tcp any any -> $HTTP_SERVERS 443 ( msg:"SERVER-OTHER OpenSSL TLSv1.2 ChangeCipherSpec man-in-the-middle exploitation attempt"; flow:to_server,established; content:"|16 03 01|",depth 3; content:"|01|",within 1,distance 2; content:"|03 03|",within 2,distance 3; byte_test:2,!=,0,33,relative; flowbits:set,tlsv1.2_handshake; flowbits:noalert; metadata:policy max-detect-ips alert; service:ssl; reference:bugtraq,67899; reference:cve,2014-0224; reference:url,www.openssl.org/news/secadv_20140605.txt; classtype:attempted-dos; sid:31484; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8045 ( msg:"SERVER-OTHER EMC AutoStart ftagent SQL injection attempt"; flow:to_server,established; content:"|31 00 00 00|",depth 4; content:"|00 00 00 00 00 00 00 53 00 00 00 16|",within 12,distance 4; pcre:"/\x00{7}\x53\x00{3}\x16.{8}[^\x00]*?[\x22\x27\x29\x3b]/"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,74426; reference:cve,2015-0538; classtype:attempted-admin; sid:35540; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8045 ( msg:"SERVER-OTHER EMC AutoStart ftagent SQL injection attempt"; flow:to_server,established; content:"|31 00 00 00|",depth 4; content:"|00 00 00 00 00 00 00 55 00 00 00 21|",within 12,distance 4; pcre:"/\x00{7}\x55\x00{3}\x21.{4}[^\x00]*?[\x22\x27\x29\x3b]/"; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,74426; reference:cve,2015-0538; classtype:attempted-admin; sid:35541; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13701 ( msg:"SERVER-OTHER Veritas NetBackup Volume Manager connection attempt"; flow:to_server,established; byte_test:1,>,3,14,dec,string; byte_test:1,<,11,14,dec,string; flowbits:set,veritas.vmd.connect; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:protocol-command-decode; sid:37546; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER Cisco ASA IKEv2 invalid fragment length heap buffer overflow attempt"; flow:to_server; content:"|84 20|",depth 2,offset 16; byte_test:2,<,8,12,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2016-1287; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160210-asa-ike; classtype:attempted-admin; sid:36903; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER Cisco ASA IKEv1 invalid fragment length heap buffer overflow attempt"; flow:to_server; content:"|84 10|",depth 2,offset 16; byte_test:2,<,8,12,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2016-1287; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160210-asa-ike; classtype:attempted-admin; sid:37674; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC stack buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|71 3C 01 00|",depth 4,offset 4; byte_test:4,>,32,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0856; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:40008; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 11460 ( msg:"SERVER-OTHER IBM Tivoli Storage Manager FastBack opcode 4115 remote code execution attempt"; flow:to_server,established; content:"|13 10 00 00|",depth 4,offset 16; isdataat:182,relative; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2015-4931; reference:url,ibm.com/support/docview.wss?uid=swg21961928; classtype:attempted-admin; sid:40422; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-OTHER OpenSSL SSLv3 warning denial of service attempt"; flow:to_server,established,only_stream; ssl_version:sslv3; content:"|15|",depth 1; content:"|01|",within 1,distance 4; detection_filter:track by_src, count 10, seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ssl; reference:cve,2016-8610; classtype:attempted-dos; sid:40843; rev:3; )
alert tcp $HOME_NET [3301,3302] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER Tarantool initial connection banner detected"; flow:to_client,established; content:"Tarantool ",depth 10; flowbits:set,tarantool; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert; reference:url,tarantool.org/doc/singlehtml.html; classtype:protocol-command-decode; sid:41081; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC stack buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|3A 52 00 00|",depth 4,offset 4; byte_test:4,>,20,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0856; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:41846; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC stack buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|75 3C 01 00|",depth 4,offset 4; byte_test:4,>,32,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0856; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:41847; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC stack buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|7F 3C 01 00|",depth 4,offset 4; byte_test:4,>,310,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0856; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:41848; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC stack buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|80 3C 01 00|",depth 4,offset 4; byte_test:4,>,36,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0856; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:41849; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER Advantech WebAccess DCERPC heap buffer overflow attempt"; flow:to_server,established; dce_iface:uuid 5d2b62aa-ee0a-4a95-91ae-b064fdb471fc; dce_opnum:"0"; dce_stub_data; content:"|28 52 00 00|",depth 4; byte_test:4,>,600,0,relative,dce; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,80745; reference:cve,2016-0857; reference:url,ics-cert.us-cert.gov/advisories/ICSA-16-014-01; classtype:attempted-admin; sid:41882; rev:1; )
alert udp $EXTERNAL_NET any -> $HOME_NET 123 ( msg:"SERVER-OTHER NTPD zero origin timestamp denial of service attempt"; flow:to_client,no_stream; content:"|06 80 00 00 00 00 00 00 00 00|",depth 10,offset 2,fast_pattern,fast_pattern_offset 0,fast_pattern_length 9; content:"|00 00 00 00 00 00 00 00|",within 8,distance 12; detection_filter:track by_src, count 7, seconds 30; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ntp; reference:cve,2016-9042; reference:url,attack.mitre.org/techniques/T1209; reference:url,www.talosintelligence.com/reports/TALOS-2016-0260/; classtype:attempted-dos; sid:41367; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9000 ( msg:"SERVER-OTHER RaySharp DVR administrative interface access attempt"; flow:to_server,established; content:"REMOTE HI_SRDK_SYS_USERMNG_GetUserList",depth 38; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:url,community.rapid7.com/community/metasploit/blog/2013/01/23/ray-sharp-cctv-dvr-password-retrieval-remote-root; reference:url,console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html; classtype:attempted-admin; sid:43045; rev:2; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4500 ( msg:"SERVER-OTHER tcpdump ISAKMP parser buffer overflow attempt"; flow:to_server; content:"|00 00 00 00|",depth 4; content:"|21 20 22|",within 3,distance 16,fast_pattern; content:!"|00|",within 1,distance 13; content:!"|02|",within 1,distance 13; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2017-5205; classtype:attempted-user; sid:44160; rev:2; )
alert tcp any any -> $HOME_NET 5159 ( msg:"SERVER-OTHER General Electric Proficy memory leakage request attempt "; flow:to_server,established; content:"|00 00 00 04|",depth 4,offset 12; byte_test:4,>,0x1000,3,big; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset limited; classtype:attempted-recon; sid:35920; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5432 ( msg:"SERVER-OTHER PostgreSQL Empty Password authentication bypass attempt"; flow:to_server,established; content:"|70 00 00 00 05 00|",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:postgresql; reference:cve,2017-7546; classtype:attempted-user; sid:46449; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 ( msg:"SERVER-OTHER Cisco Smart Install init discovery message stack buffer overflow attempt"; flow:to_server,established; content:"|00 00 00|",depth 3; content:"|00 00 00 07|",within 4,distance 5,fast_pattern; content:"|00 00 00 01|",within 4,distance 4; byte_test:4,>,28,0,relative; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2018-0171; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2; classtype:attempted-admin; sid:46096; rev:2; )
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any ( msg:"SERVER-SAMBA Microsoft Windows SMBv2/SMBv3 Buffer Overflow attempt"; flow:to_client,established; content:"|FE|SMB|40 00|",depth 6,offset 4; content:"|03 00|",within 2,distance 6; byte_test:3, >, 200, 1; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2017-0016; classtype:attempted-dos; sid:41499; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"SERVER-SAMBA Samba unsigned connections attempt"; flow:to_server, established; content:"|FF|SMB",depth 4,offset 4; byte_test:1,=,0x05,6,relative,bitmask 0x14; content:"|00 00 00 00 00 00 00 00|",within 8,distance 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2017-12150; reference:url,samba.org/samba/security/CVE-2017-12150.html; classtype:attempted-user; sid:45074; rev:3; )
